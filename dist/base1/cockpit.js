(()=>{"use strict";var e;try{e=window.localStorage.getItem("url-root")}catch(e){}!function(){var n={};if(S(n,{}),void 0===window.debugging)try{Object.defineProperty(window,"debugging",{get:function(){return window.sessionStorage.debugging||window.localStorage.debugging},set:function(e){window.sessionStorage.debugging=e}})}catch(e){}function t(e){return"function"==typeof e}function o(e){return null!==e&&"object"==typeof e}function r(e){return o(e)&&"[object Object]"===Object.prototype.toString.call(e)}function i(e){return((e=+e)||1/e)<0}function a(e){var n,t,o,r;for(n=1,t=arguments.length;n<t;n++)if(r=arguments[n])for(o in r)void 0!==r[o]&&(e[o]=r[o]);return e}function s(e,n,t){for(var o=e?e.length:0,r=0;r<o;r++)e[r]&&e[r].apply(n,t)}function l(e,n,t){var o,r,i=!1,a=0;for(t||(t=65536),e&&(e.byteLength?(a=e.byteLength,i=!0):e.length&&(a=e.length)),o=0;o<a;o+=t)r=Math.min(a-o,t),n(i?new window.Uint8Array(e.buffer,o,r):e.substr(o,r))}var c=null,u=null,d=!1,f=!1,p=null,h=null,v=null,m=null,g=null,w=window.location.origin;function b(e,n){for(var t=e.length,o=new(n||Array)(t),r=0;r<t;r++)o[r]=255&e.charCodeAt(r);return o}function y(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65}function k(e){if("string"==typeof e)return window.btoa(e);e instanceof window.ArrayBuffer&&(e=new window.Uint8Array(e));for(var n=e.length,t=2,o="",r=0,i=0;i<n;i++)t=i%3,r|=e[i]<<(16>>>t&24),2!==t&&n-i!=1||(o+=String.fromCharCode(y(r>>>18&63),y(r>>>12&63),y(r>>>6&63),y(63&r)),r=0);return o.substr(0,o.length-2+t)+(2===t?"":1===t?"=":"==")}function _(e,n){if(n===String)return window.atob(e);for(var t=e.length,o=0;o<3&&"="==e[t-(o+1)];o++);for(var r,i,a,s=(3*t+1>>2)-o,l=new(n||Array)(s),c=0,u=0,d=0;d<t;d++)if(i=3&d,c|=((a=e.charCodeAt(d))>64&&a<91?a-65:a>96&&a<123?a-71:a>47&&a<58?a+4:43===a?62:47===a?63:0)<<18-6*i,3===i||t-d==1){for(r=0;r<3&&u<s;r++,u++)l[u]=c>>>(16>>>r&24)&255;c=0}return l}function E(){"all"!=window.debugging&&"channel"!=window.debugging||console.debug.apply(console,arguments)}function S(e,n){Object.defineProperties(e,{addEventListener:{enumerable:!1,value:function(e,t){void 0===n[e]&&(n[e]=[]),n[e].push(t)}},removeEventListener:{enumerable:!1,value:function(e,t){for(var o=n[e]?n[e].length:0,r=0;r<o;r++)if(n[e][r]===t){n[e][r]=null;break}}},dispatchEvent:{enumerable:!1,value:function(o){var r,i;if("string"==typeof o){r=o,i=Array.prototype.slice.call(arguments,1);var a=null;2==arguments.length?a=arguments[1]:arguments.length>2&&(a=i),o=new CustomEvent(r,{bubbles:!1,cancelable:!1,detail:a}),i.unshift(o)}else r=o.type,i=arguments;t(e["on"+r])&&e["on"+r].apply(e,i),s(n[r],e,i)}}})}function x(){var n=window.location.pathname||"/",t=e;return window.mock&&window.mock.pathname&&(n=window.mock.pathname),window.mock&&window.mock.url_root&&(t=window.mock.url_root),t&&0===n.indexOf("/"+t)&&(n=n.replace("/"+t,"")||"/"),0!==n.indexOf("/cockpit/")&&0!==n.indexOf("/cockpit+")&&(n=0===n.indexOf("/=")?"/cockpit+"+n.split("/")[1]:"/cockpit"),n.split("/")[1]}function j(n){n||(n="socket");var t=window.location.toString(),o=e;if(window.mock&&window.mock.url)return window.mock.url;window.mock&&window.mock.url_root&&(o=window.mock.url_root);var r=x();return o&&(r=o+"/"+r),0===t.indexOf("http:")?"ws://"+window.location.host+"/"+r+"/"+n:0===t.indexOf("https:")?"wss://"+window.location.host+"/"+r+"/"+n:(E("Cockpit must be used over http or https"),null)}function O(e,n){if(!n)return e.join("");var t,o,r,i,a=0,s=e.length;for(o=0;o<s;o++)a+=e[o].length;if((t=window.Uint8Array?new window.Uint8Array(a):new Array(a)).set)for(r=0,o=0;o<s;o++)t.set(e[o],r),r+=e[o].length;else for(r=0,o=0;o<s;o++){for(i=0;i<e[o].length;i++)t[o+r]=e[o][i];r+=e[o].length}return t}function L(e){var n=this;n.readyState=0,window.addEventListener("message",(function(t){if(t.origin===w&&t.source===e){var o=t.data;void 0===o||void 0===o.length&&void 0===o.byteLength||(0===o.length?(n.readyState=3,n.onclose()):n.onmessage(t))}}),!1),n.send=function(n){e.postMessage(n,w)},n.close=function(){n.readyState=3,e.postMessage("",w),n.onclose()},window.setTimeout((function(){n.readyState=1,n.onopen()}),0)}function A(e){var n,t,o,r;if(e instanceof window.ArrayBuffer){for(t=(n=new window.Uint8Array(e)).length,o=0;o<t&&10!=n[o];o++);if(o===t)return console.warn("binary message without channel"),null;if(0===o)return console.warn("binary control message"),null;r=String.fromCharCode.apply(null,n.subarray(0,o))}else{if(-1===(o=e.indexOf("\n")))return console.warn("text message without channel"),null;r=e.substring(0,o)}return r}function C(){var e=this;e.application=x(),S(e,{});var n,t,o=0,r="";window.mock&&(window.mock.last_transport=e);var i=!1,a=!1;window.parent!==window&&0===window.name.indexOf("cockpit1:")&&(n=new L(window.parent));try{!n&&window.parent!==window&&window.parent.options&&"cockpit1"==window.parent.options.protocol&&(n=new L(window.parent))}catch(e){}if(!n){var s=j();E("connecting to "+s),s&&("WebSocket"in window?n=new window.WebSocket(s,"cockpit1"):"MozWebSocket"in window?n=new window.MozWebSocket(s):console.error("WebSocket not supported, application will not work!")),t=window.setInterval((function(){e.ready&&n.send('\n{ "command": "ping" }'),a||(i?console.log("health check failure ignored"):(console.log("health check failed"),e.close({problem:"timeout"}))),a=!1}),3e4)}n||(n={close:function(){}},window.setTimeout((function(){e.close({problem:"no-cockpit"})}),50));var l={},c={},w=!0;function y(){e.ready||(e.ready=!0,e.dispatchEvent("ready"))}e.ready=!1,n.onopen=function(){n&&(void 0!==n.binaryType&&(n.binaryType="arraybuffer"),n.send('\n{ "command": "init", "version": 1 }'))},n.onclose=function(){E("WebSocket onclose"),n=null,d&&(f=!0,window.location.reload(!0)),e.close()},n.onmessage=e.dispatch_data=function(n){a=!0;var t,o,i,s=n.data,d=A(s);if(null===d)return!1;t=s instanceof window.ArrayBuffer?new window.Uint8Array(s,d.length+1):s.substring(d.length+1),d?E("recv "+d+":",t):(E("recv control:",t),o=JSON.parse(t));var f=m?m.length:0;for(i=0;i<f;i++)if(!1===m[i](s,d,o))return!1;return d?function(e,n){var t=c[e];t&&t(n)}(d,t):function(n){var t,o=n.channel;"init"==n.command?function(n){if(n.problem)return void e.close({problem:n.problem});if(1!==n.version)return console.error("received unsupported version in init message: "+n.version),void e.close({problem:"not-supported"});n["channel-seed"]&&(r=String(n["channel-seed"]));n.host&&(h=n.host);u&&(u.options=n,u.csrf_token=n["csrf-token"],u.host=h);p&&p(n);w&&(w=!1,y())}(n):w?(w=!1,("close"!=n.command||o)&&(console.error("received message before init: ",n.command),n={problem:"protocol-error"}),e.close(n)):"ping"==n.command?(n.command="pong",e.send_control(n)):"pong"==n.command||("hint"==n.command?v&&v(n):void 0!==o&&(t=l[o])&&t(n))}(o),!0},e.close=function(e){e||(e={problem:"disconnected"}),e.command="close",window.clearInterval(t);var o=n;if(n=null,o&&o.close(),!f)for(var r in y(),l)l[r].apply(null,[e])},e.next_channel=function(){return o++,r+String(o)},e.send_data=function(e,t,o){if(!n)return!1;var r,i=g?g.length:0;for(r=0;r<i;r++)if(void 0===t&&(t=A(e)),t||void 0!==o||(o=JSON.parse(e)),!1===g[r](e,t,o))return!1;return n.send(e),!0},e.send_message=function(n,t,o){if(E(t?"send "+t:"send control:",n),n.byteLength||Array.isArray(n)){n instanceof window.ArrayBuffer&&(n=new window.Uint8Array(n));var r=O([b(t),[10],n],!0);return e.send_data(r.buffer,t,o)}return e.send_data(t.toString()+"\n"+n,t,o)},e.send_control=function(o){if(n||"close"!=o.command&&"kill"!=o.command){if(!t||"hint"!=o.command||"ignore_transport_health_check"!=o.hint)return e.send_message(JSON.stringify(o),"",o);i=o.data}},e.register=function(e,n,t){l[e]=n,c[e]=t},e.unregister=function(e){delete l[e],delete c[e]}}function I(e){var n;c||(c=new C),(n=c).ready?e(n):n.addEventListener("ready",(function(){e(n)}))}function B(e){var t,o=this;S(o,{});var r=null,i=null,a=null,s=!1,l=!1,c=null,u=!0===e.binary,d=[];function f(e){s?(console.warn("received message after done"),o.close("protocol-error")):o.dispatchEvent("message",e)}function p(e){i=e,o.valid=!1,t&&c&&t.unregister(c),i.message&&console.warn(i.message),o.dispatchEvent("close",i),a&&a.resolve(i)}function v(e){if("close"!=e.command){"ready"==e.command&&function(e){r=e,o.dispatchEvent("ready",r)}(e);var n="done"===e.command;n&&s?(console.warn("received two done commands on channel"),o.close("protocol-error")):(n&&(s=!0),o.dispatchEvent("control",e))}else p(e)}function m(e){u||"string"!=typeof e&&(e=String(e)),t.send_message(e,c)}o.valid=!0,o.options=e,o.binary=u,o.id=c,I((function(n){if(t=n,!i){c=t.next_channel(),o.id=c,t.register(c,v,f);var r={};for(var a in e)r[a]=e[a];for(r.command="open",r.channel=c,r.host||h&&(r.host=h),u?r.binary="raw":delete r.binary,r["flow-control"]=!0,t.send_control(r);d.length>0;){var s=d.shift();s[0]?(s[1].channel=c,t.send_control(s[1])):m(s[1])}}})),o.send=function(e){i?console.warn("sending message on closed channel"):l?console.warn("sending message after done"):t?m(e):d.push([!1,e])},o.control=function(e){(e=e||{}).command||(e.command="options"),"done"===e.command&&(l=!0),e.channel=c,t?t.send_control(e):d.push([!0,e])},o.wait=function(e){a||(a=n.defer(),i?a.reject(i):r?a.resolve(r):(o.addEventListener("ready",(function(e,n){a.resolve(n)})),o.addEventListener("close",(function(e,n){a.reject(n)}))));var t=a.promise;return e&&t.then(e,e),t},o.close=function(e){i||(e?"string"==typeof e&&(e={problem:e}):e={},e.command="close",e.channel=c,t?t.send_control(e):d.push([!0,e]),p(e))},o.buffer=function(e){var n=[];function t(e,t){var r,i;n.push(t),n.callback&&(i=O(n,u)).length>0&&("number"!=typeof(r=n.callback.call(o,i))||r===i.length?n.length=0:0===r?(n.length=1,n[0]=i):0!==r&&(n.length=1,i.subarray?n[0]=i.subarray(r):i.substring?n[0]=i.substring(r):n[0]=i.slice(r)))}return n.callback=e,n.squash=function(){return O(n,u)},o.addEventListener("message",t),o.addEventListener("close",(function e(){o.removeEventListener("message",t),o.removeEventListener("close",e)})),n},o.toString=function(){var n=e.host||"localhost";return"[Channel "+(o.valid?c:"<invalid>")+" -> "+n+"]"}}w||(w=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),window.addEventListener("beforeunload",(function(){f=!0}),!1),window.addEventListener("unload",(function(){c&&c.close()})),window.cockpit=function(){function f(e){this.encoding="utf-8",this.encode=function(n,t){var o=window.unescape(encodeURIComponent(n));return e===String?o:b(o,e)}}function y(e){var n=null;this.encoding="utf-8",this.decode=function(t,o){var r=o&&o.stream;null==t&&(t=""),"string"!=typeof t&&(t=function(e){for(var n=e.length,t="",o=0;o<n;o++)t+=String.fromCharCode(e[o]);return t}(t)),n&&(t=n+t,n=null);for(var i,a,s,l,c=0,u=0,d=t.length,f="";u<d;){if(!(l=u+(a=255==(i=t.charCodeAt(u))?0:i>251&&i<254?6:i>247&&i<252?5:i>239&&i<248?4:i>223&&i<240?3:i>191&&i<224?2:i<128?1:0)<=d)&&r){n=t.substring(u);break}for(0===a&&(l=!1),s=1;l&&s<a;s++)l=0!=(128&t.charCodeAt(u+s));if(l)u+=a;else{if(e){u=d;break}f+=decodeURIComponent(window.escape(t.substring(c,u))),f+="ï¿½",c=++u}}return f+=decodeURIComponent(window.escape(t.substring(c,u)))}}n.channel=function(e){return new B(e)},n.event_target=function(e){return S(e,{}),e},n.extend=a,n.manifests={},n.utf8_encoder=function(e){return new f(e)},n.utf8_decoder=function(e){return new y(!!e)},n.base64_encode=k,n.base64_decode=_,n.kill=function(e,t){var o={};e&&(o.host=e),t&&(o.group=t),n.transport.control("kill",o)},n.hint=function(e,t){c&&(t||(t=h),"string"==typeof t&&(t={host:t}),t.hint=e,n.transport.control("hint",t))},n.transport=u={wait:I,inject:function(e,n){return!!c&&(void 0===n||n?c.send_data(e):c.dispatch_data({data:e}))},filter:function(e,n){n?(g||(g=[]),g.push(e)):(m||(m=[]),m.push(e))},close:function(e){var n;e&&(n={problem:e}),c&&c.close(n),c=null,this.options={}},origin:w,options:{},uri:j,control:function(e,n){(n=a({},n)).command=e,I((function(e){e.send_control(n)}))},application:function(){return!c||window.mock?x():c.application}};var E=[],L=null;function A(){var e,n=E;for(L=null,E=[];e=n.shift();)e()}function C(e){e&&E.push(e),null===L&&(L=window.setTimeout(A,0))}function M(e,n,t,o){if(void 0===n&&void 0===t&&void 0===o)return null;var r=new T;return e.pending=e.pending||[],e.pending.push([r,n,t,o]),e.status>0&&N(e),r.promise}function N(e){!e.process_scheduled&&e.pending&&(e.process_scheduled=!0,C((function(){!function(e){var n,o,r;r=e.pending,e.process_scheduled=!1,e.pending=void 0;for(var i=0,a=r.length;i<a;++i)e.pur=!0,o=r[i][0],t(n=r[i][e.status])?o.resolve(n.apply(e.promise,e.values)):1===e.status?o.resolve.apply(o.resolve,e.values):o.reject.apply(o.reject,e.values)}(e)})))}function U(e,n){var r,i=!1;(o(n[0])||t(n[0]))&&(r=n[0]&&n[0].then),t(r)?(e.status=-1,r.call(n[0],(function(){i||(i=!0,U(e,arguments))}),(function(){i||(i=!0,J(e,arguments))}),(function(){P(e,arguments)}))):(e.values=n,e.status=1,N(e))}function J(e,n){e.values=n,e.status=2,N(e)}function P(e,n){var o=e.pending;e.status<=0&&o&&o.length&&C((function(){for(var r,i,a=0,s=o.length;a<s;a++)i=o[a][0],t(r=o[a][3])?i.notify(r.apply(e.promise,n)):i.notify.apply(i,n)}))}function T(){var e=this,n={};e.promise=n.promise=function(e){var n=function(e){return e?(a(e,n),e):n};return e.status=0,n.then=function(t,o,r){return M(e,t,o,r)||n},n.catch=function(t){return M(e,null,t)||n},n.finally=function(t,o){return M(e,(function(){return q(arguments,!0,t)}),(function(){return q(arguments,!1,t)}),o)||n},n.done=function(t){return M(e,t),n},n.fail=function(t){return M(e,null,t),n},n.always=function(t){return M(e,t,t),n},n.progress=function(t){return M(e,null,null,t),n},n.state=function(){return 1==e.status?"resolved":2==e.status?"rejected":"pending"},n.promise=n,n}(n),e.resolve=function(){if(arguments[0]===n.promise)throw new Error("Expected promise to be resolved with other value than itself");return n.status||U(n,arguments),e},e.reject=function(){if(!n.status)return J(n,arguments),e},e.notify=function(){return P(n,arguments),e}}function D(e,t){var o=n.defer();return t?o.resolve.apply(o,e):o.reject.apply(o,e),o.promise}function q(e,n,o){var r=null;return t(o)&&(r=o()),r&&t(r.then)?r.then((function(){return D(e,n)}),(function(){return D(arguments,!1)})):D(e,n)}n.when=function(e,t,o,r){var i=n.defer();return i.resolve(e),i.promise.then(t,o,r)},n.resolve=function(e){return n.defer().resolve(e).promise},n.reject=function(e){return n.defer().reject(e).promise},n.defer=function(){return new T};var R=/\$\{([^}]+)\}|\$([a-zA-Z0-9_]+)/g;function $(e,t,o,r){var i,a,s,l,c,u,d,f=null;if(e||0===e){if("string"==typeof o){for(a in s=[],t)s.push(a);for(s.sort().reverse(),c=0;c<s.length;c++){for(u=0;u<t[s[c]].length;u++)if(o==t[s[c]][u]){e/=Math.pow(s[c],u),f=o;break}if(f)break}}else if(o in t)for(l=1,d=0;d<t[o].length;d++){if((i=e/l)<o){e=i,f=t[o][d];break}l*=o}}else f=null;var p,h=n.format_number(e);return p=h&&f?[h,f]:[h],r||(p=p.join(" ")),p}n.format=function(e,n){function t(e,t,o){var r=n[t||o];return 0===r?"0":r||""}return 2==arguments.length&&o(n)&&null!==n||(n=Array.prototype.slice.call(arguments,1)),e.replace(R,t)},n.format_number=function(e){var t=void 0===n.language?void 0:n.language.replace("_","-");return e||0===e?e%1==0?e.toString():e>0&&e<=.001?.001.toLocaleString(t):e<0&&e>=-.001?(-.001).toLocaleString(t):e>999||e<-999?e.toFixed(0):e.toLocaleString(t,{maximumSignificantDigits:3,minimumSignificantDigits:3}):""};var G={1e3:[null,"KB","MB","GB","TB","PB","EB","ZB"],1024:[null,"KiB","MiB","GiB","TiB","PiB","EiB","ZiB"]};n.format_bytes=function(e,n,t){return void 0===n&&(n=1024),$(e,G,n,t)},n.get_byte_units=function(e,n){function t(e){return{name:G[n][e],factor:Math.pow(n,e)}}void 0!==n&&n in G||(n=1024);for(var o=[t(2),t(3),t(4)],r=o.length-1;r>=0;r--)if(0===r||e/o[r].factor>=10){o[r].selected=!0;break}return o};var H={1024:["B/s","KiB/s","MiB/s","GiB/s","TiB/s","PiB/s","EiB/s","ZiB/s"]};n.format_bytes_per_sec=function(e,n,t){return void 0===n&&(n=1024),$(e,H,n,t)};var K={1e3:["bps","Kbps","Mbps","Gbps","Tbps","Pbps","Ebps","Zbps"]};function z(e){var t,o=this;try{t=window[e]}catch(e){}o.prefixedKey=function(e){return n.transport.application()+":"+e},o.getItem=function(e,n){var r=t.getItem(o.prefixedKey(e));return!r&&n&&(r=t.getItem(e)),r},o.setItem=function(e,n,r){t.setItem(o.prefixedKey(e),n),r&&t.setItem(e,n)},o.removeItem=function(e,n){t.removeItem(o.prefixedKey(e)),n&&t.removeItem(e)},o.clear=function(e){for(var o=0;o<t.length;){var r=t.key(o);e&&0!==r.indexOf("cockpit")||0===r.indexOf(n.transport.application())?t.removeItem(r):o++}}}function W(e){var n;if(e.parent&&e.parent!==e&&(n=W(e.parent)),!n)try{(n=e["cv1-storage"])||(e["cv1-storage"]=n={})}catch(e){}return n}function V(e,t,o){var r,i,a=this,s=n.transport.application()+":"+e,l=window.sessionStorage,c=W(window),u=!1;function d(){var n;void 0!==c[s]&&(n=c[s],window.setTimeout((function(){!1===o(n,e)&&a.close()})))}function f(e){if(i&&!u&&(u=!0),u){var n=Math.floor(1e7*Math.random())+1,t=document.createEvent("StorageEvent");t.initStorageEvent("storage",!1,!1,s,null,n,window.location,l),c[s]=e,l.setItem(s,n),t.self=a,window.dispatchEvent(t)}}function p(){if(i&&i.close&&i.close(),i=null,u){u=!1;var e=l.getItem(s);if(e=e?parseInt(e,10):null,r&&r===e){var n=document.createEvent("StorageEvent"),t=l[s];n.initStorageEvent("storage",!1,!1,s,t,null,window.location,l),delete c[s],l.removeItem(s),n.self=a,window.dispatchEvent(n)}}}function h(e){if(e.key===s){if(e.self!==a){if(!e.newValue&&!u)return void a.claim()}else u&&!e.oldValue&&e.newValue!==l.getItem(s)&&p();var n=null;e.newValue&&(n=parseInt(e.newValue,10)),r!==n&&(r=n,d())}}a.claim=function(){if(!i){var n={close:function(){}};i=n;var o=t(f,e);i===n?i=o:o.close()}},a.close=function(){window.removeEventListener("storage",h,!0),p()},window.addEventListener("storage",h,!0),window.addEventListener("beforeunload",(function(){a.close()})),window.addEventListener("unload",(function(){a.close()})),l.getItem(s)?d():a.claim()}function Z(e,n,t){var o=this;o.interval=e,o.limit=n?65536:1024;var r=function(e){if(!e)return[];var n=W(window),t=n[e];t||(n[e]=t=[]);return t}(n),i=0,a=null,s=null;function l(e,n){for(var t,o,r=0,i=e.length-1;r<=i;)if((o=e[t=(r+i)/2|0].beg)<n)r=t+1;else{if(!(o>n))return t;i=t-1}return r}function c(e,n,o){t&&(o||u(e,new Array(n-e),{}),t(e,n,o))}function u(e,n,t){if(n.length){var c,u,d,f,p,h,v,m=l(r,e),g=e+n.length,w=r.length;for(v=m>0?m-1:m;v<w;v++)if(h=(c=r[v]).items.length)if(p=c.beg,(d=Math.max(p,e))<(f=Math.min(p+h,g)))u=f-d,c.items.splice(d-p,u),i-=u,d-p==0&&(c.beg+=f-p);else if(v>=m)break;for(c={beg:e,items:n,mapping:t},a||(a=c),s&&(s.next=c),s=c,i+=n.length,r.splice(m,0,c),m--;m<=v;m++)(c=r[m])&&!c.items.length&&(r.splice(m,1),m--);for(;a&&i>o.limit;)i-=a.items.length,a.items=[],a.mapping=null,a=a.next||null;for(w=r.length,v=0;v<w&&!(r[v].items.length>0);v++);r.splice(0,v)}}o.load=function(e,n,t){if(!(n<=e)){var o,i,a,s,u,d,p=l(r,e),h=r.length,v=e,m=[];for(d=p>0?p-1:p;d<h;d++)if(u=(o=r[d]).items.length)if(s=o.beg,(i=Math.max(s,e))<(a=Math.min(s+u,n)))i>v&&m.push([v,i]),f(i,o.items.slice(i-s,a-s),o.mapping),v=a;else if(d>=p)break;for(d=0;d<m.length;d++)c(m[d][0],m[d][1],t);v!=n&&c(v,n,t)}};var d={};function f(e,n,t){var o,r,i,a,s,l,c,u,f,p,h,v,m,g,w,b,y,k=e+n.length;for(p in d)if(v=(h=d[p]).grid,(b=Math.max(e,v.beg))<(y=Math.min(k,v.end))){for(m=b-e,g=b-v.beg,w=y-b,o=0;o<w;o++)for(s=h.links.length,a=0;a<s;a++){for(c=h.links[a][0],u=h.links[a][1],l=n[m+o],f=t,i=c.length,r=0;void 0!==l&&r<i;r++)l=l?null!=f&&(f=f[c[r]])?l[f[""]]:l[c[r]]:void 0;u[g+o]=l}v.notify(g,w)}}o._register=function(n,t){if(n.interval!=e)throw Error("mismatched metric interval between grid and sink");var o=d[t];return o||((o=d[t]={grid:n,links:[]}).links.remove=function(){delete d[t]}),o.links},o.input=function(e,n,t){f(e,n,t),u(e,n,t)},o.close=function(){var e,n;for(n in d)(e=d[n])&&e.grid&&e.grid.remove_sink(o)}}n.format_bits_per_sec=function(e,n,t){return void 0===n&&(n=1e3),$(e,K,n,t)},n.localStorage=new z("localStorage"),n.sessionStorage=new z("sessionStorage"),n.cache=function(e,n,t){return new V(e,n,t)},n.series=function(e,n,t){return new Z(e,n,t)};var F=1;function Y(e,n,r){var a=this;S(a,{});var s=[];a.interval=e,a.beg=0,a.end=0;var l=[],c=[],u=0,d="g1-"+F;F+=1;var f=null,p=null;function h(e,n,t){void 0===n&&(n=e+(a.end-a.beg)),n<e&&(e=n),a.beg=e,a.end=n,s.length&&(s.forEach((function(e){e.length=0})),a.sync(t))}function v(){window.clearInterval(f),f=null,p=null}a.notify=function(e,n){if(!(u||(e+n>a.end-a.beg&&(n=a.end-a.beg-e),n<=0))){var t,o,r,i=l.length;for(t=0;t<i;t++)o=l[t][0],r=l[t][1],o.call(a,r,e,n);a.dispatchEvent("notify",e,n)}},a.add=function(){var e,n,r,i,u=[];if(s.push(u),o(arguments[0]))e=(e=arguments[0]).series||e,(n=arguments[1])?"string"==typeof n&&(n=n.split(".")):n=[],(r=e._register(a,d)).length||c.push({sink:e,links:r}),r.push([n,u]);else if(t(arguments[0]))i=[arguments[0],u],!0===arguments[1]?l.unshift(i):l.push(i);else if(0!==arguments.length)throw Error("invalid args to grid.add()");return u},a.remove=function(e){var n,t,o,r;for(o=c.length,t=0;t<o;t++)for(r=c[t].links.length,n=0;n<r;n++)if(c[t].links[n][1]===e){c[t].links.splice(n,1);break}for(o=s.length,t=0;t<o;t++)if(s[t]===e){s.splice(t,1);break}},a.remove_sink=function(e){var n,t=c.length;for(n=0;n<t;n++)if(c[n].sink===e){c[n].links.remove(),c.splice(n,1);break}},a.sync=function(e){var n;u++;var t=c.length;for(n=0;n<t;n++)c[n].sink.load(a.beg,a.end,e);u--,a.notify(0,a.end-a.beg)},a.move=function(e,n){v();var t=null;void 0===e?e=0:i(e)&&(t=Date.now(),e=Math.floor(t/a.interval)+e),void 0!==n&&i(n)&&(null===t&&(t=Date.now()),n=Math.floor(t/a.interval)+n),h(e,n,!1)},a.walk=function(){var e=Date.now();a.interval>2e9||(v(),p=e-a.beg*a.interval,f=window.setInterval((function(){var e=Date.now();h(Math.floor((e-p)/a.interval),void 0,!0)}),a.interval))},a.close=function(){for(v();c.length;)c.pop().links.remove()},a.move(n,r)}function Q(e,t){this.problem=e,this.message=t||n.message(e),this.toString=function(){return this.message}}n.grid=function(e,n,t){return new Y(e,n,t)},n.logout=function(e,t){n.sessionStorage.clear(!0),n.localStorage.removeItem("login-data",!0),n.localStorage.clear(!1),!1!==e&&(d=!0),I((function(e){e.send_control({command:"logout",disconnect:!0})||window.location.reload(d)})),window.sessionStorage.setItem("logout-intent","explicit"),t&&window.sessionStorage.setItem("logout-reason",t)},n.drop_privileges=function(){I((function(e){e.send_control({command:"logout",disconnect:!1})}))},n.info={},S(n.info,{}),p=function(e){e.system&&a(n.info,e.system),e.system&&n.info.dispatchEvent("changed")};let X=null;n.user=function(){const e=n.defer();if(X)e.resolve(X);else{const t=n.dbus(null,{bus:"internal"});t.call("/user","org.freedesktop.DBus.Properties","GetAll",["cockpit.User"],{type:"s"}).then((([n])=>{X={id:n.Id.v,name:n.Name.v,full_name:n.Full.v,groups:n.Groups.v,home:n.Home.v,shell:n.Shell.v},e.resolve(X)})).catch((n=>e.reject(n))).finally((()=>t.close()))}return e.promise},document.addEventListener("click",(function(e){e.target.classList&&function(e,n){for(var t=e.length,o=0;o<t;o++)if(n===e[o])return!0;return!1}(e.target.classList,"disabled")&&e.stopPropagation()}),!0);var ee=null;function ne(){return window.location.href.split("#")[1]||""}function te(){var t=this,o=n.transport.application();t.url_root=e||"",0===o.indexOf("cockpit+=")&&(t.url_root&&(t.url_root+="/"),t.url_root=t.url_root+o.replace("cockpit+",""));var r=ne(),i={};function a(e){var n,o,r=e.split("/").map(decodeURIComponent),i=[];for(t.url_root&&(i=t.url_root.split("/").map(decodeURIComponent)),e&&"/"!==e[0]?((n=[].concat(t.path)).pop(),n=n.concat(r)):n=r,n=function(e){for(var n=[],t=e.length,o=0;o<t;o++){var r=e[o];if(""!==r&&"."!=r)if(".."==r){if(0===n.length)return null;n.pop()}else n.push(r)}return n}(n),o=0;o<i.length&&i[o]===n[o];o++);return o==i.length&&n.splice(0,i.length),n}function s(e,n,o){"string"==typeof e&&(e=a(e));var r,i,s="/"+e.map(encodeURIComponent).join("/");o&&t.url_root&&s.indexOf("/"+t.url_root+"/"!==0)&&(s="/"+t.url_root+s),s=(s=(s=s.replace("%40","@")).replace("%3D","=")).replace(/%2B/g,"+");var l=[];function c(e){l.push(encodeURIComponent(r)+"="+encodeURIComponent(e))}if(n){for(r in n)i=n[r],Array.isArray(i)||(i=[i]),i.forEach(c);l.length>0&&(s+="?"+l.join("&"))}return s}function l(e,n){"#"==e[0]&&(e=e.substr(1));var t=e.indexOf("?");const o=a(-1===t?e:e.substr(0,t));return-1!==t&&n&&e.substring(t+1).split("&").forEach((function(e){var t,o=e.split("="),r=decodeURIComponent(o[0]),i=decodeURIComponent(o[1]);n[r]?(t=n[r],Array.isArray(i)||(t=n[r]=[t]),t.push(i)):n[r]=i})),o}function c(){var e;if(1==arguments.length&&arguments[0]instanceof te)e=String(arguments[0]);else if("string"==typeof arguments[0]){var n=arguments[1]||{};e=s(l(arguments[0],n),n)}else e=s.apply(t,arguments);return e}t.path=l(r,i),Object.defineProperties(t,{path:{enumerable:!0,writable:!1,value:t.path},options:{enumerable:!0,writable:!1,value:i},href:{enumerable:!0,value:r},go:{value:function(){if(t===ee){var e=c.apply(t,arguments);window.location.hash="#"+e}}},replace:{value:function(){if(t===ee){var e=c.apply(t,arguments);window.location.replace(window.location.pathname+"#"+e)}}},encode:{value:s},decode:{value:l},toString:{value:function(){return r}}})}function oe(e,t){this.problem=e.problem||null,this.exit_status=e["exit-status"],void 0===this.exit_status&&(this.exit_status=null),this.exit_signal=e["exit-signal"],void 0===this.exit_signal&&(this.exit_signal=null),this.message=e.message,void 0===this.message?this.problem?this.message=n.message(e.problem):null!==this.exit_signal?this.message=n.format(ve("$0 killed with signal $1"),t,this.exit_signal):void 0!==this.exit_status?this.message=n.format(ve("$0 exited with code $1"),t,this.exit_status):this.message=n.format(ve("$0 failed"),t):this.message=this.message.trim(),this.toString=function(){return this.message}}function re(){"all"!=window.debugging&&"spawn"!=window.debugging||console.debug.apply(console,arguments)}function ie(){"all"!=window.debugging&&"dbus"!=window.debugging||console.debug.apply(console,arguments)}function ae(e,t){"string"==typeof e?(this.problem=e,this.name=null,this.message=t||n.message(e)):(this.problem=null,this.name=e[0],this.message=e[1][0]||e[0]),this.toString=function(){return this.message}}function se(){var e=this,n=[];function t(e,t,o){var r,i=n.slice(),a=i.length;for(r=0;r<a;r++){var s=i[r];s[0]&&s[0]!==e||s[1]&&s[1]!==t||s[2](o,e)}}e.data={},e.meta={},e.connect=function(e,t,o,r){var i=[e,t,o];return r?n.unshift(i):n.push(i),{remove:function(){var r,i=n.length;for(r=0;r<i;r++){var a=n[r];if(a[0]===e&&a[1]===t&&a[2]===o){delete a[r];break}}}}},e.update=function(n,o,r){e.data[n]||(e.data[n]={}),e.data[n][o]?r=a(e.data[n][o],r):e.data[n][o]=r,t(n,o,r)},e.remove=function(n,o){e.data[n]&&(delete e.data[n][o],t(n,o,null))},e.lookup=function(n,t){if(e.data[n])return e.data[n][t]},e.each=function(n,t){for(const o in e.data)for(const r in e.data[o])r==n&&t(e.data[o][n],o)},e.close=function(){e.data={};var t,o=n;n=[];var r=o.length;for(t=0;t<r;t++)o[t].callback()}}function le(e,t,o,r,i){var s=this;S(s,{});var l=!1,c=!1,u=n.defer();function d(i){i?(a(s.data,i),c||function(){if(t.meta[o]){var i=t.meta[o];c=!0,Object.keys(i.methods||{}).forEach((function(t){t[0].toLowerCase()!=t[0]&&Object.defineProperty(s,t,{enumerable:!1,value:function(){var i=n.defer();return e.call(r,o,t,Array.prototype.slice.call(arguments)).done((function(e){i.resolve.apply(i,e)})).fail((function(e){i.reject(e)})),i.promise}})})),Object.keys(i.properties||{}).forEach((function(t){if(t[0].toLowerCase()!=t[0]){var a={enumerable:!0,get:function(){return s.data[t]},set:function(e){throw Error(t+"is not writable")}},l=i.properties[t];l.flags&&-1!==l.flags.indexOf("w")&&(a.set=function(i){e.call(r,"org.freedesktop.DBus.Properties","Set",[o,t,n.variant(l.type,i)]).fail((function(e){console.log("Couldn't set "+o+" "+t+" at "+r+": "+e)}))}),Object.defineProperty(s,t,a)}}))}}(),l=!0):l=!1,s.dispatchEvent("changed",i)}function f(e){l?u.resolve():u.reject(e)}Object.defineProperties(s,{client:{value:e,enumerable:!1,writable:!1},path:{value:r,enumerable:!1,writable:!1},iface:{value:o,enumerable:!1,writable:!1},valid:{get:function(){return l},enumerable:!1},wait:{enumerable:!1,writable:!1,value:function(e){return e&&u.promise.always(e),u.promise}},call:{value:function(n,t,i){return e.call(r,o,n,t,i)},enumerable:!1,writable:!1},data:{value:{},enumerable:!1}}),"function"==typeof window.$&&Object.defineProperty(s,window.$.expando,{value:{},writable:!0,enumerable:!1}),i||(i={}),t.connect(r,o,d,!0),d(t.lookup(r,o)),e.subscribe({path:r,interface:o},(function(e,n,t,o){s.dispatchEvent("signal",t,o),t[0].toLowerCase()!=t[0]&&((o=o.slice()).unshift(t),s.dispatchEvent.apply(s,o))}),!1!==i.subscribe),!1!==i.watch?e.watch({path:r,interface:o}).always(f):f()}function ce(e,t,o,r,i){var s,l=this;S(l,{}),Object.defineProperties(l,{client:{value:e,enumerable:!1,writable:!1},iface:{value:o,enumerable:!1,writable:!1},path_namespace:{value:r,enumerable:!1,writable:!1},wait:{enumerable:!1,writable:!1,value:function(e){return e&&s.always(e),s}}}),"function"==typeof window.$&&Object.defineProperty(l,window.$.expando,{value:{},writable:!0,enumerable:!1});var c={interface:o,path_namespace:r};function u(n,t){var r=l[t];t&&(!n&&r?(delete l[t],l.dispatchEvent("removed",r)):n&&(r||(r=l[t]=e.proxy(o,t,i),l.dispatchEvent("added",r)),l.dispatchEvent("changed",r)))}e.subscribe(c),s=!1!==i.watch?e.watch(c):n.defer().resolve().promise,i=a({watch:!1,subscribe:!1},i),t.connect(null,o,u,!1),t.each(o,u)}function ue(e,t){var o=this;S(o,{});var i={},s=!1,l=null;t&&(t.track&&(s=!0),delete t.track,a(i,t)),i.payload="dbus-json3",e&&(i.name=e),o.options=t,o.unique_name=null,ie("dbus open: ",i);var c,u,d=n.channel(i),f={},p={},h={};function v(){c||(c=new se)}function m(e){return!(!d||!d.valid)&&(ie("dbus:",e),d.send(e),!0)}function g(e,t){var r,i,a;ie("dbus:",t);try{r=JSON.parse(t)}catch(e){console.warn("received invalid dbus json message:",e)}void 0!==r?(void 0!==r.id&&(i=h[r.id]),r.reply?i&&(a={},r.type&&(a.type=r.type),r.flags&&(a.flags=r.flags),i.resolve(r.reply[0]||[],a),delete h[r.id]):r.error?i&&(i.reject(new ae(r.error)),delete h[r.id]):C((function(){var e,i,a,u;if(r.signal)for(e in f)(i=f[e]).callback&&(a=r.signal,(u=i.match).path&&a[0]!==u.path||u.path_namespace&&0!==a[0].indexOf(u.path_namespace)||u.interface&&a[1]!==u.interface||u.member&&a[2]!==u.member||u.arg0&&(!a[3]||a[3][0]!==u.arg0)||i.callback.apply(o,r.signal));else r.call?function(e,t){var o=function(e){var t=e[0],o=e[1],r=e[2],i=p[t+"\n"+o],a=c.meta[o];return i&&a?a.methods&&r in a.methods?"function"!=typeof i[r]?function(e,n,t){return console.warn("method is not implemented properly: ",e,n,t),E(e,n,t)}(t,o,r):i[r].apply(i,e[3]):E(t,o,r):function(e,t){var o="DBus interface "+t+" not available at "+e;return n.reject(new ae(["org.freedesktop.DBus.Error.UnknownInterface",[o]]))}(t,o)}(e);if(!t)return;n.when(o).then((function(){var e=Array.prototype.slice.call(arguments,0);1==e.length&&void 0===e[0]&&(e=[]),m(JSON.stringify({reply:[e],id:t}))}),(function(e){var o=[];o[0]=e.name||" org.freedesktop.DBus.Error.Failed",o[1]=[n.message(e)||o[0]],m(JSON.stringify({error:o,id:t}))}))}(r.call,r.id):r.notify?b(r.notify):r.meta?w(r.meta):void 0!==r.owner?(o.dispatchEvent("owner",r.owner),s&&l&&o.close(),l=r.owner):ie("received unexpected dbus json message:",t)}))):d.close({problem:"protocol-error"})}function w(e){v(),a(c.meta,e),o.dispatchEvent("meta",e)}function b(e){var n,t,r;for(n in v(),e)for(t in e[n])(r=e[n][t])?c.update(n,t,r):c.remove(n,t);o.dispatchEvent("notify",e)}function y(e){var n;u=e.problem||"disconnected";var t=h;for(n in h={},t)t[n].reject(new ae(u,e.message));o.dispatchEvent("close",e)}function k(e,n){ie("dbus ready:",t),o.unique_name=n["unique-name"]}o.constructors={"*":le},o.wait=d.wait,o.meta=function(e,n){if(d&&d.valid){var t=a({},n,{meta:e});m(JSON.stringify(t)),w(e)}},this.notify=b,this.close=function(e){"string"==typeof e&&(e={problem:e}),e||(e={}),d?d.close(e):y(e)},d.addEventListener("ready",k),d.addEventListener("message",g),d.addEventListener("close",(function e(n,t){ie("dbus close:",t),d.removeEventListener("ready",k),d.removeEventListener("message",g),d.removeEventListener("close",e),d=null,y(t)}));var _=1;function E(e,t,o){var r="DBus method "+t+" "+o+" not available at "+e;return n.reject(new ae(["org.freedesktop.DBus.Error.UnknownMethod",[r]]))}this.call=function(e,t,o,r,i){var s=n.defer(),l=String(_);_++;var c=a({},i,{call:[e,t,o,r||[]],id:l});return m(JSON.stringify(c))?h[l]=s:s.reject(new ae(u)),s.promise},o.signal=function(e,n,t,o,r){if(d&&d.valid){var i=a({},r,{signal:[e,n,t,o||[]]});m(JSON.stringify(i))}},this.subscribe=function(e,n,t){var o,r={match:a({},e),callback:n};return!1!==t&&m(JSON.stringify({"add-match":r.match})),n&&(o=String(_),_++,f[o]=r),{remove:function(){var e;o&&(e=f[o])&&delete f[o],!1!==t&&e&&m(JSON.stringify({"remove-match":e.match}))}}},o.watch=function(e){var t;t=r(e)?a({},e):{path:String(e)};var o=String(_);_++;var i=n.defer();m(JSON.stringify({watch:t,id:o}))?h[o]=i:i.reject(new ae(u));var s=i.promise;return s.remove=function(){o in h&&(i.reject(new ae("cancelled")),delete h[o]),m(JSON.stringify({unwatch:t}))},s},o.publish=function(e,t,o,r){var i=[e,t],s=String(_);_++;var l=h[s]=n.defer();m(JSON.stringify(a({},r,{publish:i,id:s})))?h[s]=l:l.reject(new ae(u));var c=e+"\n"+t;l.promise.then((function(){p[c]=o}));var d=l.promise;return d.remove=function(){s in h&&(l.reject(new ae("cancelled")),delete h[s]),delete p[c],m(JSON.stringify({unpublish:i}))},d},o.proxy=function(n,t,r){n||(n=e),n=String(n),t||(t="/"+n.replace(/\./g,"/"));var i=o.constructors[n];return i||(i=o.constructors["*"]),r||(r={}),v(),new i(o,c,n,String(t),r)},o.proxies=function(n,t,r){return n||(n=e),t||(t="/"),r||(r={}),v(),new ce(o,c,String(n),String(t),r)}}Object.defineProperty(n,"location",{enumerable:!0,get:function(){return ee&&ee.href===ne()||(ee=new te),ee},set:function(e){n.location.go(e)}}),window.addEventListener("hashchange",(function(){ee=null;var e=window.location.hash;0===e.indexOf("#")&&(e=e.substring(1)),n.hint("location",{hash:e}),n.dispatchEvent("locationchanged")})),n.jump=function(e,t){e=Array.isArray(e)?"/"+e.map(encodeURIComponent).join("/").replace("%40","@").replace("%3D","=").replace(/%2B/g,"+"):""+e,void 0===t&&(t=n.transport.host);var o={command:"jump",location:e,host:t};n.transport.inject("\n"+JSON.stringify(o))},function(){var e,t=!1;function o(){var o=document[e];e&&void 0!==o||(o=!1),!1===o&&(o=t),n.hidden!==o&&(n.hidden=o,n.dispatchEvent("visibilitychange"))}void 0!==document.hidden?(e="hidden",document.addEventListener("visibilitychange",o)):void 0!==document.mozHidden?(e="mozHidden",document.addEventListener("mozvisibilitychange",o)):void 0!==document.msHidden?(e="msHidden",document.addEventListener("msvisibilitychange",o)):void 0!==document.webkitHidden&&(e="webkitHidden",document.addEventListener("webkitvisibilitychange",o)),v=function(e){"hidden"in e&&(t=e.hidden,o())},o()}(),n.spawn=function(e,t){var o=n.defer(),r={payload:"stream",spawn:[]};if(e instanceof Array)for(var i=0;i<e.length;i++)r.spawn.push(String(e[i]));else r.spawn.push(String(e));void 0!==t&&a(r,t);var s=r.spawn[0]||"process",c=n.channel(r),u=c.buffer(null);c.addEventListener("close",(function(e,n){var t=u.squash();re("process closed:",JSON.stringify(n)),t&&re("process output:",t),void 0!==n.message&&re("process error:",n.message),n.problem?o.reject(new oe(n,s)):n["exit-status"]||n["exit-signal"]?o.reject(new oe(n,s),t):void 0!==n.message?o.resolve(t,n.message):o.resolve(t)}));var d=o.promise;return d.stream=function(e){return u.callback=e.bind(d),this},d.input=function(e,n){return null!=e&&(re("process input:",e),l(e,(function(e){c.send(e)}))),n||c.control({command:"done"}),this},d.close=function(e){return re("process closing:",e),c.valid&&c.close(e),this},d},n.script=function(e,t,o){!o&&r(t)&&(o=t,t=[]);var i=["/bin/sh","-c",e,"--"];return i.push.apply(i,t),n.spawn(i,o)};var de={internal:null,session:null,system:null};n.dbus=function(e,n){n||(n={bus:"system"});var t=Object.keys(n),o=n.bus,r=!e&&1==t.length&&o in de;if(r&&de[o])return de[o];var i=new ue(e,n);if(r){const e=i.close;i.close=function(){arguments.length>0&&e.apply(i,arguments)},i.addEventListener("close",(function(){de[o]==i&&(de[o]=null)})),de[o]=i}return i},n.variant=function(e,n){return{v:n,t:e}},n.byte_array=function(e){return window.btoa(e)},n.file=function(e,t){var o=(t=t||{}).binary,r={path:e,read:d,replace:p,modify:function(e,t,o){var r=n.defer();function i(n,t){var o=e(n);void 0===o&&(o=n),p(o,t).done((function(e){r.resolve(o,e)})).fail((function(e){"change-conflict"==e.problem?a():r.reject(e)}))}function a(){d().done(i).fail((function(e){r.reject(e)}))}void 0===t?a():i(t,o);return r.promise},watch:function(e,n){e&&v.push(e);return m+=1,w(n),h=null,d(),{remove:function(){var t;e&&(t=v.indexOf(e))>-1&&(v[t]=null),m-=1,w(n)}}},close:function(){c&&c.close("cancelled");f&&f.close("cancelled");g&&g.close("cancelled")}},i=a({},t);delete i.syntax;var c,u=null;function d(){if(u)return u;var r=n.defer(),s=a({},i,{payload:"fsread1",path:e});return function e(){c=n.channel(s);var i=[];c.addEventListener("message",(function(e,n){i.push(n)})),c.addEventListener("close",(function(n,a){if(c=null,"change-conflict"!=a.problem){if(u=null,a.problem){var s=new Q(a.problem,a.message);return b(null,null,s),void r.reject(s)}var l,d;if("-"==a.tag)l=null;else try{d=O(i,o),l=t.syntax&&t.syntax.parse?t.syntax.parse(d):d}catch(e){return b(null,null,e),void r.reject(e)}b(l,a.tag),r.resolve(l,a.tag)}else e()}))}(),u=r.promise}var f=null;function p(o,r){var s,c,u=n.defer();try{null===o?s=null:(c=o,s=t.syntax&&t.syntax.stringify?t.syntax.stringify(c):c)}catch(e){return u.reject(e),u.promise}f&&f.close("abort");var d=a({},i,{payload:"fsreplace1",path:e,tag:r});return(f=n.channel(d)).addEventListener("close",(function(e,n){f=null,n.problem?u.reject(new Q(n.problem,n.message)):(b(o,n.tag),u.resolve(n.tag))})),l(s,(function(e){f.send(e)})),f.control({command:"done"}),u.promise}var h,v=[],m=0,g=null;function w(t){if(m>0){if(g)return;const o={payload:"fswatch1",path:e,superuser:i.superuser};(g=n.channel(o)).addEventListener("message",(function(n,o){var r;try{r=JSON.parse(o)}catch(e){r=null}r&&r.path==e&&r.tag&&r.tag!=h&&(t&&void 0!==t.read&&!t.read?b(null,r.tag):d())}))}else g&&(g.close(),g=null)}function b(){h=arguments[1]||null,s(v,r,arguments)}return r};var fe,pe={};function he(e){return!0===e?1:e||0}n.language="en",n.locale=function(e){var t,o=n.language;e?(a(pe,e),t=e[""]):null===e&&(pe={}),t&&(t["plural-forms"]&&(fe=t["plural-forms"]),t.language&&(o=t.language)),n.language=o},n.translate=function(){var e,t,o,r,i,a,s,l,c,u,d;for(t=0,o=(e=0===arguments.length?[document]:1===arguments.length&&arguments[0].length?arguments[0]:arguments).length;t<o;t++)if(c=null,e[t].querySelectorAll&&(c=e[t].querySelectorAll("[translatable], [translate]")),c)for(i=0,a=c.length;i<a;i++)if("no"!=(r=(d=c[i]).getAttribute("translate")||d.getAttribute("translatable")||"yes")){for(u=r.split(" "),r=d.getAttribute("translate-context")||d.getAttribute("context"),s=0,l=u.length;s<l;s++)"yes"==u[s]||"translate"==u[s]?d.textContent=n.gettext(r,d.textContent):u[s]&&d.setAttribute(u[s],n.gettext(r,d.getAttribute(u[s])||""));d.removeAttribute("translatable"),d.removeAttribute("translate")}},n.gettext=function(e,n){1==arguments.length&&(n=e,e=void 0);var t=e?e+""+n:n;if(pe){var o=pe[t];if(o&&o[1])return o[1]}return n},n.ngettext=function(e,n,t,o){3==arguments.length&&(o=t,t=n,n=e,e=void 0);var r=e?e+""+n:n;if(pe&&fe){var i=pe[r];if(i){var a=he(fe(o))+1;if(i[a])return i[a]}}return 1==o?n:t},n.noop=function(e,n){return arguments[arguments.length-1]};var ve=n.gettext;function me(e,n,t){this.status=parseInt(e,10),this.reason=n,this.message=t||n,this.problem=null,this.valueOf=function(){return this.status},this.toString=function(){return this.status+" "+this.message}}function ge(){"all"!=window.debugging&&"http"!=window.debugging||console.debug.apply(console,arguments)}function we(e,n){if(e)for(var t in n=n.toLowerCase(),e)if(t.toLowerCase()==n)return e[t]}function be(e,t){var o=this;o.options=t,t.payload="http-stream2";var i=[];if(void 0!==e)if(e.indexOf&&0===e.indexOf("/"))t.unix=e;else{var c=parseInt(e,10);if(isNaN(c))throw Error("The endpoint must be either a unix path or port number");t.port=c}function u(e){return Object.keys(e).map((function(n){return encodeURIComponent(n)+"="+encodeURIComponent(e[n])})).join("&").split("%20").join("+")}t.address&&(t.capabilities||(t.capabilities=[]),t.capabilities.push("address")),o.request=function(e){var o=n.defer(),r=o.promise;e.path||(e.path="/"),e.method||(e.method="GET"),e.params&&(-1===e.path.indexOf("?")?e.path+="?"+u(e.params):e.path+="&"+u(e.params)),delete e.params;var c=e.body;delete e.body;var d=e.headers;delete e.headers,a(e,t),t.headers&&d?e.headers=a({},t.headers,d):t.headers?e.headers=t.headers:e.headers=d,ge("http request:",JSON.stringify(e));var f=n.channel(e);void 0!==c&&(""!==c&&(ge("http input:",c),l(c,(function(e){f.send(e)}))),ge("http done"),f.control({command:"done"}));var p=null,h=null,v=null,m=f.buffer((function(e){return v&&v.status>=200&&v.status<=299&&p?p.call(r,e):0}));function g(e,n){"response"==n.command&&(v=n,h&&(v.headers=v.headers||{},s(h,r,[v.status,v.headers])))}return f.addEventListener("control",g),f.addEventListener("close",(function e(n,t){var a=i.indexOf(r);if(a>=0&&i.splice(a,1),t.problem)ge("http problem: ",t.problem),o.reject(new Q(t.problem));else{var s=m.squash();if(v&&(v.status<200||v.status>299)){var l,c=we(v.headers,"Content-Type");c&&!f.binary&&0===c.indexOf("text/plain")&&(l=s),ge("http status: ",v.status),o.reject(new me(v.status,v.reason,l),s)}else ge("http done"),o.resolve(s)}f.removeEventListener("control",g),f.removeEventListener("close",e)})),r.stream=function(e){return p=e,r},r.response=function(e){return null===h&&(h=[]),h.push(e),r},r.input=function(e,n){return null!=e&&(ge("http input:",e),l(e,(function(e){f.send(e)}))),n||(ge("http done"),f.control({command:"done"})),r},r.close=function(e){return ge("http closing:",e),f.close(e),r},i.push(r),r},o.get=function(e,n,t){return o.request({method:"GET",params:n,path:e,body:"",headers:t})},o.post=function(e,n,t){return t=t||{},r(n)||Array.isArray(n)?(n=JSON.stringify(n),void 0===we(t,"Content-Type")&&(t["Content-Type"]="application/json")):null==n?n="":"string"!=typeof n&&(n=String(n)),o.request({method:"POST",path:e,body:n,headers:t})},o.close=function(e){for(var n=i.slice(),t=0;t<n.length;t++)n[t].close(e)}}function ye(e){var t=this;S(t,{});var o=n.dbus(null,{bus:"internal"}).proxy("cockpit.Superuser","/superuser");function r(){o.valid&&null!==t.allowed&&t.allowed!=("none"!=o.Current)&&window.location.reload(!0)}o.addEventListener("changed",r),t.allowed=null,t.user=e?e.user:null,t.is_superuser=e?e._is_superuser:null;var i=null,a=!1;function s(e){return 0===e.id||(i?!!(e.groups||[]).includes(i):a?t.is_superuser:void 0===e.id&&null)}e&&(i=e.group),e&&e.admin&&(a=!0),t.user&&null!==t.is_superuser?t.allowed=s(t.user):Promise.all([n.user(),new Promise(((e,t)=>{const o=n.channel({payload:"null",superuser:"require"});o.wait().then((()=>e(!0))).catch((()=>e(!1))).always((()=>o.close()))}))]).then((([e,n])=>{t.user=e,t.is_superuser=n;const o=s(e);t.allowed!==o&&(t.allowed=o,r(),t.dispatchEvent("changed"))})),t.close=function(){}}function ke(e,t,o){var r=this;S(r,{}),void 0===t.length&&(t=[t]);var i=[],s=!1;function l(t,o,c){if(0!==t.length){if(!c){if(s)return;s=!0}var u=a({payload:"metrics1",interval:e,source:"internal"},t[0]);delete u.archive_source;var d=n.channel(u);i.push(d);var f,p=null,h=null;d.addEventListener("close",(function(e,n){c||(s=!1),t.length>1&&("not-supported"==n.problem||"not-found"==n.problem)?l(t.slice(1),o):n.problem?"terminated"==n.problem||"disconnected"==n.problem||"authentication-failed"==n.problem||"not-found"==n.problem&&c||"not-supported"==n.problem&&c||console.warn("metrics channel failed: "+n.problem):c&&(r.archives||(r.archives=!0,r.dispatchEvent("changed")))})),d.addEventListener("message",(function(n,i){var a,s,l,c,u,d,v,m,g,w,b=JSON.parse(i),y=b.length;if(void 0===y)w=0,(p=b).now&&p.timestamp&&(w=p.timestamp+(Date.now()-p.now)),f=Math.floor(w/e),o(f,p,null,t[0]),r.meta=p,r.dispatchEvent("changed");else if(p){for(v=0;v<y;v++){if(a=b[v],h)for(s=h.length,m=0;m<s;m++)if(null==(l=a[m]))a[m]=h[m];else if(void 0!==(c=l.length)){for(u=h[m],d=h[m].length,g=0;g<c;g++)null===l[g]&&(l[g]=u[g]);for(;g<d;g++)l[g]=u[g]}h=a}o(f,p,b,t[0]),f+=y,p.timestamp+=e*y}}))}}function c(e,n,t,o){var i,a,s;(i=n.mapping)||(i={},n.metrics.forEach((function(e,n){a={"":n},s=o.metrics_path_names?o.metrics_path_names[n]:e.name,i[s]=a,e.instances&&e.instances.forEach((function(e,n){""===e&&(e="/"),a[e]={"":n}}))})),n.mapping=i),t&&r.series.input(e,t,i)}r.series=n.series(e,o,(function(e,n,t){t?r.follow():r.fetch(e,n)})),r.archives=null,r.meta=null,r.fetch=function(n,o){for(var r=n*e-Date.now(),i=o-n,s=[],u=0;u<t.length;u++)t[u].archive_source&&s.push(a({},t[u],{source:t[u].archive_source,timestamp:r,limit:i}));l(s,c,!0)},r.follow=function(){l(t,c)},r.close=function(e){var n,t=i.length;for(r.series&&r.series.close(),n=0;n<t;n++)i[n].close(e)}}n.message=function(e){if(e.message)return e.message;var n=null;return"terminated"==(n=e.problem?e.problem:e+"")?ve("Your session has been terminated."):"no-session"==n?ve("Your session has expired. Please log in again."):"access-denied"==n?ve("Not permitted to perform this action."):"authentication-failed"==n?ve("Login failed"):"authentication-not-supported"==n?ve("The server refused to authenticate using any supported methods."):"unknown-hostkey"==n||"unknown-host"==n?ve("Untrusted host"):"invalid-hostkey"==n?ve("Host key is incorrect"):"internal-error"==n?ve("Internal error"):"timeout"==n?ve("Connection has timed out."):"no-cockpit"==n?ve("Cockpit is not installed on the system."):"no-forwarding"==n?ve("Cannot forward login credentials"):"disconnected"==n?ve("Server has closed the connection."):"not-supported"==n?ve("Cockpit is not compatible with the software on the system."):"no-host"==n?ve("Cockpit could not contact the given host."):"too-large"==n?ve("Too much data"):n},n.http=function(e,n){return r(e)&&void 0===n&&(n=e,e=void 0),new be(e,n||{})},n.permission=function(e){return new ye(e)},n.metrics=function(e,n){return new ke(e,n)},n.oops=function(){window.parent!==window&&0===window.name.indexOf("cockpit1:")&&window.parent.postMessage('\n{ "command": "oops" }',w)};var _e=window.onerror;return window.onerror=function(e,t,o){return n.oops(),!!_e&&_e(e,t,o)},n}()}()})();