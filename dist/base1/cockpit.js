(()=>{"use strict";var e;try{e=window.localStorage.getItem("url-root")}catch(e){}!function(){var n={};if(S(n,{}),void 0===window.debugging)try{Object.defineProperty(window,"debugging",{get:function(){return window.sessionStorage.debugging||window.localStorage.debugging},set:function(e){window.sessionStorage.debugging=e}})}catch(e){}function t(e){return"function"==typeof e}function r(e){return null!==e&&"object"==typeof e}function o(e){return r(e)&&"[object Object]"===Object.prototype.toString.call(e)}function i(e){return((e=+e)||1/e)<0}function a(e){var n,t,r,o;for(n=1,t=arguments.length;n<t;n++)if(o=arguments[n])for(r in o)void 0!==o[r]&&(e[r]=o[r]);return e}function s(e,n,t){for(var r=e?e.length:0,o=0;o<r;o++)e[o]&&e[o].apply(n,t)}function l(e,n,t){var r,o,i=!1,a=0;for(t||(t=65536),e&&(e.byteLength?(a=e.byteLength,i=!0):e.length&&(a=e.length)),r=0;r<a;r+=t)o=Math.min(a-r,t),n(i?new window.Uint8Array(e.buffer,r,o):e.substr(r,o))}var c=null,u=null,d=!1,f=!1,p=null,h=null,v=null,m=null,g=null,w=window.location.origin;function b(e,n){for(var t=e.length,r=new(n||Array)(t),o=0;o<t;o++)r[o]=255&e.charCodeAt(o);return r}function y(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65}function k(e){if("string"==typeof e)return window.btoa(e);e instanceof window.ArrayBuffer&&(e=new window.Uint8Array(e));for(var n=e.length,t=2,r="",o=0,i=0;i<n;i++)t=i%3,o|=e[i]<<(16>>>t&24),2!==t&&n-i!=1||(r+=String.fromCharCode(y(o>>>18&63),y(o>>>12&63),y(o>>>6&63),y(63&o)),o=0);return r.substr(0,r.length-2+t)+(2===t?"":1===t?"=":"==")}function _(e,n){if(n===String)return window.atob(e);for(var t=e.length,r=0;r<3&&"="==e[t-(r+1)];r++);for(var o,i,a,s=(3*t+1>>2)-r,l=new(n||Array)(s),c=0,u=0,d=0;d<t;d++)if(i=3&d,c|=((a=e.charCodeAt(d))>64&&a<91?a-65:a>96&&a<123?a-71:a>47&&a<58?a+4:43===a?62:47===a?63:0)<<18-6*i,3===i||t-d==1){for(o=0;o<3&&u<s;o++,u++)l[u]=c>>>(16>>>o&24)&255;c=0}return l}function E(){"all"!=window.debugging&&"channel"!=window.debugging||console.debug.apply(console,arguments)}function S(e,n){Object.defineProperties(e,{addEventListener:{enumerable:!1,value:function(e,t){void 0===n[e]&&(n[e]=[]),n[e].push(t)}},removeEventListener:{enumerable:!1,value:function(e,t){for(var r=n[e]?n[e].length:0,o=0;o<r;o++)if(n[e][o]===t){n[e][o]=null;break}}},dispatchEvent:{enumerable:!1,value:function(r){var o,i;if("string"==typeof r){o=r,i=Array.prototype.slice.call(arguments,1);var a=null;2==arguments.length?a=arguments[1]:arguments.length>2&&(a=i),r=new CustomEvent(o,{bubbles:!1,cancelable:!1,detail:a}),i.unshift(r)}else o=r.type,i=arguments;t(e["on"+o])&&e["on"+o].apply(e,i),s(n[o],e,i)}}})}function x(){var n=window.location.pathname||"/",t=e;return window.mock&&window.mock.pathname&&(n=window.mock.pathname),window.mock&&window.mock.url_root&&(t=window.mock.url_root),t&&0===n.indexOf("/"+t)&&(n=n.replace("/"+t,"")||"/"),0!==n.indexOf("/cockpit/")&&0!==n.indexOf("/cockpit+")&&(n=0===n.indexOf("/=")?"/cockpit+"+n.split("/")[1]:"/cockpit"),n.split("/")[1]}function j(n){n||(n="socket");var t=window.location.toString(),r=e;if(window.mock&&window.mock.url)return window.mock.url;window.mock&&window.mock.url_root&&(r=window.mock.url_root);var o=x();return r&&(o=r+"/"+o),0===t.indexOf("http:")?"ws://"+window.location.host+"/"+o+"/"+n:0===t.indexOf("https:")?"wss://"+window.location.host+"/"+o+"/"+n:(E("Cockpit must be used over http or https"),null)}function O(e,n){if(!n)return e.join("");var t,r,o,i,a=0,s=e.length;for(r=0;r<s;r++)a+=e[r].length;if((t=window.Uint8Array?new window.Uint8Array(a):new Array(a)).set)for(o=0,r=0;r<s;r++)t.set(e[r],o),o+=e[r].length;else for(o=0,r=0;r<s;r++){for(i=0;i<e[r].length;i++)t[r+o]=e[r][i];o+=e[r].length}return t}function L(e){var n=this;n.readyState=0,window.addEventListener("message",(function(t){if(t.origin===w&&t.source===e){var r=t.data;void 0===r||void 0===r.length&&void 0===r.byteLength||(0===r.length?(n.readyState=3,n.onclose()):n.onmessage(t))}}),!1),n.send=function(n){e.postMessage(n,w)},n.close=function(){n.readyState=3,e.postMessage("",w),n.onclose()},window.setTimeout((function(){n.readyState=1,n.onopen()}),0)}function A(e){var n,t,r,o;if(e instanceof window.ArrayBuffer){for(t=(n=new window.Uint8Array(e)).length,r=0;r<t&&10!=n[r];r++);if(r===t)return console.warn("binary message without channel"),null;if(0===r)return console.warn("binary control message"),null;o=String.fromCharCode.apply(null,n.subarray(0,r))}else{if(-1===(r=e.indexOf("\n")))return console.warn("text message without channel"),null;o=e.substring(0,r)}return o}function C(){var e=this;e.application=x(),S(e,{});var n,t,r=0,o="";window.mock&&(window.mock.last_transport=e);var i=!1,a=!1;window.parent!==window&&0===window.name.indexOf("cockpit1:")&&(n=new L(window.parent));try{!n&&window.parent!==window&&window.parent.options&&"cockpit1"==window.parent.options.protocol&&(n=new L(window.parent))}catch(e){}if(!n){var s=j();E("connecting to "+s),s&&("WebSocket"in window?n=new window.WebSocket(s,"cockpit1"):"MozWebSocket"in window?n=new window.MozWebSocket(s):console.error("WebSocket not supported, application will not work!")),t=window.setInterval((function(){e.ready&&n.send('\n{ "command": "ping" }'),a||(i?console.log("health check failure ignored"):(console.log("health check failed"),e.close({problem:"timeout"}))),a=!1}),3e4)}n||(n={close:function(){}},window.setTimeout((function(){e.close({problem:"no-cockpit"})}),50));var l={},c={},w=!0;function y(){e.ready||(e.ready=!0,e.dispatchEvent("ready"))}e.ready=!1,n.onopen=function(){n&&(void 0!==n.binaryType&&(n.binaryType="arraybuffer"),n.send('\n{ "command": "init", "version": 1 }'))},n.onclose=function(){E("WebSocket onclose"),n=null,d&&(f=!0,window.location.reload(!0)),e.close()},n.onmessage=e.dispatch_data=function(n){a=!0;var t,r,i,s=n.data,d=A(s);if(null===d)return!1;t=s instanceof window.ArrayBuffer?new window.Uint8Array(s,d.length+1):s.substring(d.length+1),d?E("recv "+d+":",t):(E("recv control:",t),r=JSON.parse(t));var f=m?m.length:0;for(i=0;i<f;i++)if(!1===m[i](s,d,r))return!1;return d?function(e,n){var t=c[e];t&&t(n)}(d,t):function(n){var t,r=n.channel;"init"==n.command?function(n){if(n.problem)return void e.close({problem:n.problem});if(1!==n.version)return console.error("received unsupported version in init message: "+n.version),void e.close({problem:"not-supported"});n["channel-seed"]&&(o=String(n["channel-seed"]));n.host&&(h=n.host);u&&(u.options=n,u.csrf_token=n["csrf-token"],u.host=h);p&&p(n);w&&(w=!1,y())}(n):w?(w=!1,("close"!=n.command||r)&&(console.error("received message before init: ",n.command),n={problem:"protocol-error"}),e.close(n)):"ping"==n.command?(n.command="pong",e.send_control(n)):"pong"==n.command||("hint"==n.command?v&&v(n):void 0!==r&&(t=l[r])&&t(n))}(r),!0},e.close=function(e){e||(e={problem:"disconnected"}),e.command="close",window.clearInterval(t);var r=n;if(n=null,r&&r.close(),!f)for(var o in y(),l)l[o].apply(null,[e])},e.next_channel=function(){return r++,o+String(r)},e.send_data=function(e,t,r){if(!n)return!1;var o,i=g?g.length:0;for(o=0;o<i;o++)if(void 0===t&&(t=A(e)),t||void 0!==r||(r=JSON.parse(e)),!1===g[o](e,t,r))return!1;return n.send(e),!0},e.send_message=function(n,t,r){if(E(t?"send "+t:"send control:",n),n.byteLength||Array.isArray(n)){n instanceof window.ArrayBuffer&&(n=new window.Uint8Array(n));var o=O([b(t),[10],n],!0);return e.send_data(o.buffer,t,r)}return e.send_data(t.toString()+"\n"+n,t,r)},e.send_control=function(r){if(n||"close"!=r.command&&"kill"!=r.command){if(!t||"hint"!=r.command||"ignore_transport_health_check"!=r.hint)return e.send_message(JSON.stringify(r),"",r);i=r.data}},e.register=function(e,n,t){l[e]=n,c[e]=t},e.unregister=function(e){delete l[e],delete c[e]}}function I(e){var n;c||(c=new C),(n=c).ready?e(n):n.addEventListener("ready",(function(){e(n)}))}function B(e){var t,r=this;S(r,{});var o=null,i=null,a=null,s=!1,l=!1,c=null,u=!0===e.binary,d=[];function f(e){s?(console.warn("received message after done"),r.close("protocol-error")):r.dispatchEvent("message",e)}function p(e){i=e,r.valid=!1,t&&c&&t.unregister(c),i.message&&console.warn(i.message),r.dispatchEvent("close",i),a&&a.resolve(i)}function v(e){if("close"!=e.command){"ready"==e.command&&function(e){o=e,r.dispatchEvent("ready",o)}(e);var n="done"===e.command;n&&s?(console.warn("received two done commands on channel"),r.close("protocol-error")):(n&&(s=!0),r.dispatchEvent("control",e))}else p(e)}function m(e){u||"string"!=typeof e&&(e=String(e)),t.send_message(e,c)}r.valid=!0,r.options=e,r.binary=u,r.id=c,I((function(n){if(t=n,!i){c=t.next_channel(),r.id=c,t.register(c,v,f);var o={};for(var a in e)o[a]=e[a];for(o.command="open",o.channel=c,o.host||h&&(o.host=h),u?o.binary="raw":delete o.binary,o["flow-control"]=!0,t.send_control(o);d.length>0;){var s=d.shift();s[0]?(s[1].channel=c,t.send_control(s[1])):m(s[1])}}})),r.send=function(e){i?console.warn("sending message on closed channel"):l?console.warn("sending message after done"):t?m(e):d.push([!1,e])},r.control=function(e){(e=e||{}).command||(e.command="options"),"done"===e.command&&(l=!0),e.channel=c,t?t.send_control(e):d.push([!0,e])},r.wait=function(e){a||(a=n.defer(),i?a.reject(i):o?a.resolve(o):(r.addEventListener("ready",(function(e,n){a.resolve(n)})),r.addEventListener("close",(function(e,n){a.reject(n)}))));var t=a.promise;return e&&t.then(e,e),t},r.close=function(e){i||(e?"string"==typeof e&&(e={problem:e}):e={},e.command="close",e.channel=c,t?t.send_control(e):d.push([!0,e]),p(e))},r.buffer=function(e){var n=[];function t(e,t){var o,i;n.push(t),n.callback&&(i=O(n,u)).length>0&&("number"!=typeof(o=n.callback.call(r,i))||o===i.length?n.length=0:0===o?(n.length=1,n[0]=i):0!==o&&(n.length=1,i.subarray?n[0]=i.subarray(o):i.substring?n[0]=i.substring(o):n[0]=i.slice(o)))}return n.callback=e,n.squash=function(){return O(n,u)},r.addEventListener("message",t),r.addEventListener("close",(function e(){r.removeEventListener("message",t),r.removeEventListener("close",e)})),n},r.toString=function(){var n=e.host||"localhost";return"[Channel "+(r.valid?c:"<invalid>")+" -> "+n+"]"}}w||(w=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),window.addEventListener("beforeunload",(function(){f=!0}),!1),window.addEventListener("unload",(function(){c&&c.close()})),window.cockpit=function(){function f(e){this.encoding="utf-8",this.encode=function(n,t){var r=window.unescape(encodeURIComponent(n));return e===String?r:b(r,e)}}function y(e){var n=null;this.encoding="utf-8",this.decode=function(t,r){var o=r&&r.stream;null==t&&(t=""),"string"!=typeof t&&(t=function(e){for(var n=e.length,t="",r=0;r<n;r++)t+=String.fromCharCode(e[r]);return t}(t)),n&&(t=n+t,n=null);for(var i,a,s,l,c=0,u=0,d=t.length,f="";u<d;){if(!(l=u+(a=255==(i=t.charCodeAt(u))?0:i>251&&i<254?6:i>247&&i<252?5:i>239&&i<248?4:i>223&&i<240?3:i>191&&i<224?2:i<128?1:0)<=d)&&o){n=t.substring(u);break}for(0===a&&(l=!1),s=1;l&&s<a;s++)l=0!=(128&t.charCodeAt(u+s));if(l)u+=a;else{if(e){u=d;break}f+=decodeURIComponent(window.escape(t.substring(c,u))),f+="ï¿½",c=++u}}return f+=decodeURIComponent(window.escape(t.substring(c,u)))}}n.channel=function(e){return new B(e)},n.event_target=function(e){return S(e,{}),e},n.extend=a,n.manifests={},n.utf8_encoder=function(e){return new f(e)},n.utf8_decoder=function(e){return new y(!!e)},n.base64_encode=k,n.base64_decode=_,n.kill=function(e,t){var r={};e&&(r.host=e),t&&(r.group=t),n.transport.control("kill",r)},n.hint=function(e,t){c&&(t||(t=h),"string"==typeof t&&(t={host:t}),t.hint=e,n.transport.control("hint",t))},n.transport=u={wait:I,inject:function(e,n){return!!c&&(void 0===n||n?c.send_data(e):c.dispatch_data({data:e}))},filter:function(e,n){n?(g||(g=[]),g.push(e)):(m||(m=[]),m.push(e))},close:function(e){var n;e&&(n={problem:e}),c&&c.close(n),c=null,this.options={}},origin:w,options:{},uri:j,control:function(e,n){(n=a({},n)).command=e,I((function(e){e.send_control(n)}))},application:function(){return!c||window.mock?x():c.application}};var E=[],L=null;function A(){var e,n=E;for(L=null,E=[];e=n.shift();)e()}function C(e){e&&E.push(e),null===L&&(L=window.setTimeout(A,0))}function M(e,n,t,r){if(void 0===n&&void 0===t&&void 0===r)return null;var o=new T;return e.pending=e.pending||[],e.pending.push([o,n,t,r]),e.status>0&&N(e),o.promise}function N(e){!e.process_scheduled&&e.pending&&(e.process_scheduled=!0,C((function(){!function(e){var n,r,o;o=e.pending,e.process_scheduled=!1,e.pending=void 0;for(var i=0,a=o.length;i<a;++i)e.pur=!0,r=o[i][0],t(n=o[i][e.status])?r.resolve(n.apply(e.promise,e.values)):1===e.status?r.resolve.apply(r.resolve,e.values):r.reject.apply(r.reject,e.values)}(e)})))}function U(e,n){var o,i=!1;(r(n[0])||t(n[0]))&&(o=n[0]&&n[0].then),t(o)?(e.status=-1,o.call(n[0],(function(){i||(i=!0,U(e,arguments))}),(function(){i||(i=!0,P(e,arguments))}),(function(){J(e,arguments)}))):(e.values=n,e.status=1,N(e))}function P(e,n){e.values=n,e.status=2,N(e)}function J(e,n){var r=e.pending;e.status<=0&&r&&r.length&&C((function(){for(var o,i,a=0,s=r.length;a<s;a++)i=r[a][0],t(o=r[a][3])?i.notify(o.apply(e.promise,n)):i.notify.apply(i,n)}))}function T(){var e=this,n={};e.promise=n.promise=function(e){var n=function(e){return e?(a(e,n),e):n};return e.status=0,n.then=function(t,r,o){return M(e,t,r,o)||n},n.catch=function(t){return M(e,null,t)||n},n.finally=function(t,r){return M(e,(function(){return q(arguments,!0,t)}),(function(){return q(arguments,!1,t)}),r)||n},n.done=function(t){return M(e,t),n},n.fail=function(t){return M(e,null,t),n},n.always=function(t){return M(e,t,t),n},n.progress=function(t){return M(e,null,null,t),n},n.state=function(){return 1==e.status?"resolved":2==e.status?"rejected":"pending"},n.promise=n,n}(n),e.resolve=function(){if(arguments[0]===n.promise)throw new Error("Expected promise to be resolved with other value than itself");return n.status||U(n,arguments),e},e.reject=function(){if(!n.status)return P(n,arguments),e},e.notify=function(){return J(n,arguments),e}}function D(e,t){var r=n.defer();return t?r.resolve.apply(r,e):r.reject.apply(r,e),r.promise}function q(e,n,r){var o=null;return t(r)&&(o=r()),o&&t(o.then)?o.then((function(){return D(e,n)}),(function(){return D(arguments,!1)})):D(e,n)}n.when=function(e,t,r,o){var i=n.defer();return i.resolve(e),i.promise.then(t,r,o)},n.resolve=function(e){return n.defer().resolve(e).promise},n.reject=function(e){return n.defer().reject(e).promise},n.defer=function(){return new T};var R=/\$\{([^}]+)\}|\$([a-zA-Z0-9_]+)/g;function $(e,t,r,o){var i,a,s,l,c,u,d,f=null;if(e||0===e){if("string"==typeof r){for(a in s=[],t)s.push(a);for(s.sort().reverse(),c=0;c<s.length;c++){for(u=0;u<t[s[c]].length;u++)if(r==t[s[c]][u]){e/=Math.pow(s[c],u),f=r;break}if(f)break}}else if(r in t)for(l=1,d=0;d<t[r].length;d++){if((i=e/l)<r){e=i,f=t[r][d];break}l*=r}}else f=null;var p,h=n.format_number(e);return p=h&&f?[h,f]:[h],o||(p=p.join(" ")),p}n.format=function(e,n){function t(e,t,r){var o=n[t||r];return 0===o?"0":o||""}return 2==arguments.length&&r(n)&&null!==n||(n=Array.prototype.slice.call(arguments,1)),e.replace(R,t)},n.format_number=function(e){var t=void 0===n.language?void 0:n.language.replace("_","-");return e||0===e?e%1==0?e.toString():e>0&&e<=.001?.001.toLocaleString(t):e<0&&e>=-.001?(-.001).toLocaleString(t):e>999||e<-999?e.toFixed(0):e.toLocaleString(t,{maximumSignificantDigits:3,minimumSignificantDigits:3}):""};var G={1e3:[null,"KB","MB","GB","TB","PB","EB","ZB"],1024:[null,"KiB","MiB","GiB","TiB","PiB","EiB","ZiB"]};n.format_bytes=function(e,n,t){return void 0===n&&(n=1024),$(e,G,n,t)},n.get_byte_units=function(e,n){function t(e){return{name:G[n][e],factor:Math.pow(n,e)}}void 0!==n&&n in G||(n=1024);for(var r=[t(2),t(3),t(4)],o=r.length-1;o>=0;o--)if(0===o||e/r[o].factor>=10){r[o].selected=!0;break}return r};var H={1024:["B/s","KiB/s","MiB/s","GiB/s","TiB/s","PiB/s","EiB/s","ZiB/s"]};n.format_bytes_per_sec=function(e,n,t){return void 0===n&&(n=1024),$(e,H,n,t)};var K={1e3:["bps","Kbps","Mbps","Gbps","Tbps","Pbps","Ebps","Zbps"]};function z(e){var t,r=this;try{t=window[e]}catch(e){}r.prefixedKey=function(e){return n.transport.application()+":"+e},r.getItem=function(e,n){var o=t.getItem(r.prefixedKey(e));return!o&&n&&(o=t.getItem(e)),o},r.setItem=function(e,n,o){t.setItem(r.prefixedKey(e),n),o&&t.setItem(e,n)},r.removeItem=function(e,n){t.removeItem(r.prefixedKey(e)),n&&t.removeItem(e)},r.clear=function(e){for(var r=0;r<t.length;){var o=t.key(r);e&&0!==o.indexOf("cockpit")||0===o.indexOf(n.transport.application())?t.removeItem(o):r++}}}function W(e){var n;if(e.parent&&e.parent!==e&&(n=W(e.parent)),!n)try{(n=e["cv1-storage"])||(e["cv1-storage"]=n={})}catch(e){}return n}function V(e,t,r){var o,i,a=this,s=n.transport.application()+":"+e,l=window.sessionStorage,c=W(window),u=!1;function d(){var n;void 0!==c[s]&&(n=c[s],window.setTimeout((function(){!1===r(n,e)&&a.close()})))}function f(e){if(i&&!u&&(u=!0),u){var n=Math.floor(1e7*Math.random())+1,t=document.createEvent("StorageEvent");t.initStorageEvent("storage",!1,!1,s,null,n,window.location,l),c[s]=e,l.setItem(s,n),t.self=a,window.dispatchEvent(t)}}function p(){if(i&&i.close&&i.close(),i=null,u){u=!1;var e=l.getItem(s);if(e=e?parseInt(e,10):null,o&&o===e){var n=document.createEvent("StorageEvent"),t=l[s];n.initStorageEvent("storage",!1,!1,s,t,null,window.location,l),delete c[s],l.removeItem(s),n.self=a,window.dispatchEvent(n)}}}function h(e){if(e.key===s){if(e.self!==a){if(!e.newValue&&!u)return void a.claim()}else u&&!e.oldValue&&e.newValue!==l.getItem(s)&&p();var n=null;e.newValue&&(n=parseInt(e.newValue,10)),o!==n&&(o=n,d())}}a.claim=function(){if(!i){var n={close:function(){}};i=n;var r=t(f,e);i===n?i=r:r.close()}},a.close=function(){window.removeEventListener("storage",h,!0),p()},window.addEventListener("storage",h,!0),window.addEventListener("beforeunload",(function(){a.close()})),window.addEventListener("unload",(function(){a.close()})),l.getItem(s)?d():a.claim()}function Z(e,n,t){var r=this;r.interval=e,r.limit=n?65536:1024;var o=function(e){if(!e)return[];var n=W(window),t=n[e];t||(n[e]=t=[]);return t}(n),i=0,a=null,s=null;function l(e,n){for(var t,r,o=0,i=e.length-1;o<=i;)if((r=e[t=(o+i)/2|0].beg)<n)o=t+1;else{if(!(r>n))return t;i=t-1}return o}function c(e,n,r){t&&(r||u(e,new Array(n-e),{}),t(e,n,r))}function u(e,n,t){if(n.length){var c,u,d,f,p,h,v,m=l(o,e),g=e+n.length,w=o.length;for(v=m>0?m-1:m;v<w;v++)if(h=(c=o[v]).items.length)if(p=c.beg,(d=Math.max(p,e))<(f=Math.min(p+h,g)))u=f-d,c.items.splice(d-p,u),i-=u,d-p==0&&(c.beg+=f-p);else if(v>=m)break;for(c={beg:e,items:n,mapping:t},a||(a=c),s&&(s.next=c),s=c,i+=n.length,o.splice(m,0,c),m--;m<=v;m++)(c=o[m])&&!c.items.length&&(o.splice(m,1),m--);for(;a&&i>r.limit;)i-=a.items.length,a.items=[],a.mapping=null,a=a.next||null;for(w=o.length,v=0;v<w&&!(o[v].items.length>0);v++);o.splice(0,v)}}r.load=function(e,n,t){if(!(n<=e)){var r,i,a,s,u,d,p=l(o,e),h=o.length,v=e,m=[];for(d=p>0?p-1:p;d<h;d++)if(u=(r=o[d]).items.length)if(s=r.beg,(i=Math.max(s,e))<(a=Math.min(s+u,n)))i>v&&m.push([v,i]),f(i,r.items.slice(i-s,a-s),r.mapping),v=a;else if(d>=p)break;for(d=0;d<m.length;d++)c(m[d][0],m[d][1],t);v!=n&&c(v,n,t)}};var d={};function f(e,n,t){var r,o,i,a,s,l,c,u,f,p,h,v,m,g,w,b,y,k=e+n.length;for(p in d)if(v=(h=d[p]).grid,(b=Math.max(e,v.beg))<(y=Math.min(k,v.end))){for(m=b-e,g=b-v.beg,w=y-b,r=0;r<w;r++)for(s=h.links.length,a=0;a<s;a++){for(c=h.links[a][0],u=h.links[a][1],l=n[m+r],f=t,i=c.length,o=0;void 0!==l&&o<i;o++)l=l?null!=f&&(f=f[c[o]])?l[f[""]]:l[c[o]]:void 0;u[g+r]=l}v.notify(g,w)}}r._register=function(n,t){if(n.interval!=e)throw Error("mismatched metric interval between grid and sink");var r=d[t];return r||((r=d[t]={grid:n,links:[]}).links.remove=function(){delete d[t]}),r.links},r.input=function(e,n,t){f(e,n,t),u(e,n,t)},r.close=function(){var e,n;for(n in d)(e=d[n])&&e.grid&&e.grid.remove_sink(r)}}n.format_bits_per_sec=function(e,n,t){return void 0===n&&(n=1e3),$(e,K,n,t)},n.localStorage=new z("localStorage"),n.sessionStorage=new z("sessionStorage"),n.cache=function(e,n,t){return new V(e,n,t)},n.series=function(e,n,t){return new Z(e,n,t)};var F=1;function Y(e,n,o){var a=this;S(a,{});var s=[];a.interval=e,a.beg=0,a.end=0;var l=[],c=[],u=0,d="g1-"+F;F+=1;var f=null,p=null;function h(e,n,t){void 0===n&&(n=e+(a.end-a.beg)),n<e&&(e=n),a.beg=e,a.end=n,s.length&&(s.forEach((function(e){e.length=0})),a.sync(t))}function v(){window.clearInterval(f),f=null,p=null}a.notify=function(e,n){if(!(u||(e+n>a.end-a.beg&&(n=a.end-a.beg-e),n<=0))){var t,r,o,i=l.length;for(t=0;t<i;t++)r=l[t][0],o=l[t][1],r.call(a,o,e,n);a.dispatchEvent("notify",e,n)}},a.add=function(){var e,n,o,i,u=[];if(s.push(u),r(arguments[0]))e=(e=arguments[0]).series||e,(n=arguments[1])?"string"==typeof n&&(n=n.split(".")):n=[],(o=e._register(a,d)).length||c.push({sink:e,links:o}),o.push([n,u]);else if(t(arguments[0]))i=[arguments[0],u],!0===arguments[1]?l.unshift(i):l.push(i);else if(0!==arguments.length)throw Error("invalid args to grid.add()");return u},a.remove=function(e){var n,t,r,o;for(r=c.length,t=0;t<r;t++)for(o=c[t].links.length,n=0;n<o;n++)if(c[t].links[n][1]===e){c[t].links.splice(n,1);break}for(r=s.length,t=0;t<r;t++)if(s[t]===e){s.splice(t,1);break}},a.remove_sink=function(e){var n,t=c.length;for(n=0;n<t;n++)if(c[n].sink===e){c[n].links.remove(),c.splice(n,1);break}},a.sync=function(e){var n;u++;var t=c.length;for(n=0;n<t;n++)c[n].sink.load(a.beg,a.end,e);u--,a.notify(0,a.end-a.beg)},a.move=function(e,n){v();var t=null;void 0===e?e=0:i(e)&&(t=Date.now(),e=Math.floor(t/a.interval)+e),void 0!==n&&i(n)&&(null===t&&(t=Date.now()),n=Math.floor(t/a.interval)+n),h(e,n,!1)},a.walk=function(){var e=Date.now();a.interval>2e9||(v(),p=e-a.beg*a.interval,f=window.setInterval((function(){var e=Date.now();h(Math.floor((e-p)/a.interval),void 0,!0)}),a.interval))},a.close=function(){for(v();c.length;)c.pop().links.remove()},a.move(n,o)}function Q(e,t){this.problem=e,this.message=t||n.message(e),this.toString=function(){return this.message}}n.grid=function(e,n,t){return new Y(e,n,t)},n.logout=function(e,t){n.sessionStorage.clear(!0),n.localStorage.removeItem("login-data",!0),n.localStorage.clear(!1),!1!==e&&(d=!0),I((function(e){e.send_control({command:"logout",disconnect:!0})||window.location.reload(d)})),window.sessionStorage.setItem("logout-intent","explicit"),t&&window.sessionStorage.setItem("logout-reason",t)},n.drop_privileges=function(){I((function(e){e.send_control({command:"logout",disconnect:!1})}))},n.info={},S(n.info,{}),p=function(e){e.system&&a(n.info,e.system),e.system&&n.info.dispatchEvent("changed")};let X=null;n.user=function(){if(X)return Promise.resolve(X);{const e=n.dbus(null,{bus:"internal"});return e.call("/user","org.freedesktop.DBus.Properties","GetAll",["cockpit.User"],{type:"s"}).then((([e])=>(X={id:e.Id.v,name:e.Name.v,full_name:e.Full.v,groups:e.Groups.v,home:e.Home.v,shell:e.Shell.v},X))).finally((()=>e.close()))}},document.addEventListener("click",(function(e){e.target.classList&&function(e,n){for(var t=e.length,r=0;r<t;r++)if(n===e[r])return!0;return!1}(e.target.classList,"disabled")&&e.stopPropagation()}),!0);var ee=null;function ne(){return window.location.href.split("#")[1]||""}function te(){var t=this,r=n.transport.application();t.url_root=e||"",0===r.indexOf("cockpit+=")&&(t.url_root&&(t.url_root+="/"),t.url_root=t.url_root+r.replace("cockpit+",""));var o=ne(),i={};function a(e){var n,r,o=e.split("/").map(decodeURIComponent),i=[];for(t.url_root&&(i=t.url_root.split("/").map(decodeURIComponent)),e&&"/"!==e[0]?((n=[].concat(t.path)).pop(),n=n.concat(o)):n=o,n=function(e){for(var n=[],t=e.length,r=0;r<t;r++){var o=e[r];if(""!==o&&"."!=o)if(".."==o){if(0===n.length)return null;n.pop()}else n.push(o)}return n}(n),r=0;r<i.length&&i[r]===n[r];r++);return r==i.length&&n.splice(0,i.length),n}function s(e,n,r){"string"==typeof e&&(e=a(e));var o,i,s="/"+e.map(encodeURIComponent).join("/");r&&t.url_root&&s.indexOf("/"+t.url_root+"/"!==0)&&(s="/"+t.url_root+s),s=(s=(s=s.replace("%40","@")).replace("%3D","=")).replace(/%2B/g,"+");var l=[];function c(e){l.push(encodeURIComponent(o)+"="+encodeURIComponent(e))}if(n){for(o in n)i=n[o],Array.isArray(i)||(i=[i]),i.forEach(c);l.length>0&&(s+="?"+l.join("&"))}return s}function l(e,n){"#"==e[0]&&(e=e.substr(1));var t=e.indexOf("?");const r=a(-1===t?e:e.substr(0,t));return-1!==t&&n&&e.substring(t+1).split("&").forEach((function(e){var t,r=e.split("="),o=decodeURIComponent(r[0]),i=decodeURIComponent(r[1]);n[o]?(t=n[o],Array.isArray(i)||(t=n[o]=[t]),t.push(i)):n[o]=i})),r}function c(){var e;if(1==arguments.length&&arguments[0]instanceof te)e=String(arguments[0]);else if("string"==typeof arguments[0]){var n=arguments[1]||{};e=s(l(arguments[0],n),n)}else e=s.apply(t,arguments);return e}t.path=l(o,i),Object.defineProperties(t,{path:{enumerable:!0,writable:!1,value:t.path},options:{enumerable:!0,writable:!1,value:i},href:{enumerable:!0,value:o},go:{value:function(){if(t===ee){var e=c.apply(t,arguments);window.location.hash="#"+e}}},replace:{value:function(){if(t===ee){var e=c.apply(t,arguments);window.location.replace(window.location.pathname+"#"+e)}}},encode:{value:s},decode:{value:l},toString:{value:function(){return o}}})}function re(e,t){this.problem=e.problem||null,this.exit_status=e["exit-status"],void 0===this.exit_status&&(this.exit_status=null),this.exit_signal=e["exit-signal"],void 0===this.exit_signal&&(this.exit_signal=null),this.message=e.message,void 0===this.message?this.problem?this.message=n.message(e.problem):null!==this.exit_signal?this.message=n.format(ve("$0 killed with signal $1"),t,this.exit_signal):void 0!==this.exit_status?this.message=n.format(ve("$0 exited with code $1"),t,this.exit_status):this.message=n.format(ve("$0 failed"),t):this.message=this.message.trim(),this.toString=function(){return this.message}}function oe(){"all"!=window.debugging&&"spawn"!=window.debugging||console.debug.apply(console,arguments)}function ie(){"all"!=window.debugging&&"dbus"!=window.debugging||console.debug.apply(console,arguments)}function ae(e,t){"string"==typeof e?(this.problem=e,this.name=null,this.message=t||n.message(e)):(this.problem=null,this.name=e[0],this.message=e[1][0]||e[0]),this.toString=function(){return this.message}}function se(){var e=this,n=[];function t(e,t,r){var o,i=n.slice(),a=i.length;for(o=0;o<a;o++){var s=i[o];s[0]&&s[0]!==e||s[1]&&s[1]!==t||s[2](r,e)}}e.data={},e.meta={},e.connect=function(e,t,r,o){var i=[e,t,r];return o?n.unshift(i):n.push(i),{remove:function(){var o,i=n.length;for(o=0;o<i;o++){var a=n[o];if(a[0]===e&&a[1]===t&&a[2]===r){delete a[o];break}}}}},e.update=function(n,r,o){e.data[n]||(e.data[n]={}),e.data[n][r]?o=a(e.data[n][r],o):e.data[n][r]=o,t(n,r,o)},e.remove=function(n,r){e.data[n]&&(delete e.data[n][r],t(n,r,null))},e.lookup=function(n,t){if(e.data[n])return e.data[n][t]},e.each=function(n,t){for(const r in e.data)for(const o in e.data[r])o==n&&t(e.data[r][n],r)},e.close=function(){e.data={};var t,r=n;n=[];var o=r.length;for(t=0;t<o;t++)r[t].callback()}}function le(e,t,r,o,i){var s=this;S(s,{});var l=!1,c=!1,u=n.defer();function d(i){i?(a(s.data,i),c||function(){if(t.meta[r]){var i=t.meta[r];c=!0,Object.keys(i.methods||{}).forEach((function(t){t[0].toLowerCase()!=t[0]&&Object.defineProperty(s,t,{enumerable:!1,value:function(){var i=n.defer();return e.call(o,r,t,Array.prototype.slice.call(arguments)).done((function(e){i.resolve.apply(i,e)})).fail((function(e){i.reject(e)})),i.promise}})})),Object.keys(i.properties||{}).forEach((function(t){if(t[0].toLowerCase()!=t[0]){var a={enumerable:!0,get:function(){return s.data[t]},set:function(e){throw Error(t+"is not writable")}},l=i.properties[t];l.flags&&-1!==l.flags.indexOf("w")&&(a.set=function(i){e.call(o,"org.freedesktop.DBus.Properties","Set",[r,t,n.variant(l.type,i)]).fail((function(e){console.log("Couldn't set "+r+" "+t+" at "+o+": "+e)}))}),Object.defineProperty(s,t,a)}}))}}(),l=!0):l=!1,s.dispatchEvent("changed",i)}function f(e){l?u.resolve():u.reject(e)}Object.defineProperties(s,{client:{value:e,enumerable:!1,writable:!1},path:{value:o,enumerable:!1,writable:!1},iface:{value:r,enumerable:!1,writable:!1},valid:{get:function(){return l},enumerable:!1},wait:{enumerable:!1,writable:!1,value:function(e){return e&&u.promise.always(e),u.promise}},call:{value:function(n,t,i){return e.call(o,r,n,t,i)},enumerable:!1,writable:!1},data:{value:{},enumerable:!1}}),"function"==typeof window.$&&Object.defineProperty(s,window.$.expando,{value:{},writable:!0,enumerable:!1}),i||(i={}),t.connect(o,r,d,!0),d(t.lookup(o,r)),e.subscribe({path:o,interface:r},(function(e,n,t,r){s.dispatchEvent("signal",t,r),t[0].toLowerCase()!=t[0]&&((r=r.slice()).unshift(t),s.dispatchEvent.apply(s,r))}),!1!==i.subscribe),!1!==i.watch?e.watch({path:o,interface:r}).always(f):f()}function ce(e,t,r,o,i){var s,l=this;S(l,{}),Object.defineProperties(l,{client:{value:e,enumerable:!1,writable:!1},iface:{value:r,enumerable:!1,writable:!1},path_namespace:{value:o,enumerable:!1,writable:!1},wait:{enumerable:!1,writable:!1,value:function(e){return e&&s.always(e),s}}}),"function"==typeof window.$&&Object.defineProperty(l,window.$.expando,{value:{},writable:!0,enumerable:!1});var c={interface:r,path_namespace:o};function u(n,t){var o=l[t];t&&(!n&&o?(delete l[t],l.dispatchEvent("removed",o)):n&&(o||(o=l[t]=e.proxy(r,t,i),l.dispatchEvent("added",o)),l.dispatchEvent("changed",o)))}e.subscribe(c),s=!1!==i.watch?e.watch(c):n.defer().resolve().promise,i=a({watch:!1,subscribe:!1},i),t.connect(null,r,u,!1),t.each(r,u)}function ue(e,t){var r=this;S(r,{});var i={},s=!1,l=null;t&&(t.track&&(s=!0),delete t.track,a(i,t)),i.payload="dbus-json3",e&&(i.name=e),r.options=t,r.unique_name=null,ie("dbus open: ",i);var c,u,d=n.channel(i),f={},p={},h={};function v(){c||(c=new se)}function m(e){return!(!d||!d.valid)&&(ie("dbus:",e),d.send(e),!0)}function g(e,t){var o,i,a;ie("dbus:",t);try{o=JSON.parse(t)}catch(e){console.warn("received invalid dbus json message:",e)}void 0!==o?(void 0!==o.id&&(i=h[o.id]),o.reply?i&&(a={},o.type&&(a.type=o.type),o.flags&&(a.flags=o.flags),i.resolve(o.reply[0]||[],a),delete h[o.id]):o.error?i&&(i.reject(new ae(o.error)),delete h[o.id]):C((function(){var e,i,a,u;if(o.signal)for(e in f)(i=f[e]).callback&&(a=o.signal,(u=i.match).path&&a[0]!==u.path||u.path_namespace&&0!==a[0].indexOf(u.path_namespace)||u.interface&&a[1]!==u.interface||u.member&&a[2]!==u.member||u.arg0&&(!a[3]||a[3][0]!==u.arg0)||i.callback.apply(r,o.signal));else o.call?function(e,t){var r=function(e){var t=e[0],r=e[1],o=e[2],i=p[t+"\n"+r],a=c.meta[r];return i&&a?a.methods&&o in a.methods?"function"!=typeof i[o]?function(e,n,t){return console.warn("method is not implemented properly: ",e,n,t),E(e,n,t)}(t,r,o):i[o].apply(i,e[3]):E(t,r,o):function(e,t){var r="DBus interface "+t+" not available at "+e;return n.reject(new ae(["org.freedesktop.DBus.Error.UnknownInterface",[r]]))}(t,r)}(e);if(!t)return;n.when(r).then((function(){var e=Array.prototype.slice.call(arguments,0);1==e.length&&void 0===e[0]&&(e=[]),m(JSON.stringify({reply:[e],id:t}))}),(function(e){var r=[];r[0]=e.name||" org.freedesktop.DBus.Error.Failed",r[1]=[n.message(e)||r[0]],m(JSON.stringify({error:r,id:t}))}))}(o.call,o.id):o.notify?b(o.notify):o.meta?w(o.meta):void 0!==o.owner?(r.dispatchEvent("owner",o.owner),s&&l&&r.close(),l=o.owner):ie("received unexpected dbus json message:",t)}))):d.close({problem:"protocol-error"})}function w(e){v(),a(c.meta,e),r.dispatchEvent("meta",e)}function b(e){var n,t,o;for(n in v(),e)for(t in e[n])(o=e[n][t])?c.update(n,t,o):c.remove(n,t);r.dispatchEvent("notify",e)}function y(e){var n;u=e.problem||"disconnected";var t=h;for(n in h={},t)t[n].reject(new ae(u,e.message));r.dispatchEvent("close",e)}function k(e,n){ie("dbus ready:",t),r.unique_name=n["unique-name"]}r.constructors={"*":le},r.wait=d.wait,r.meta=function(e,n){if(d&&d.valid){var t=a({},n,{meta:e});m(JSON.stringify(t)),w(e)}},this.notify=b,this.close=function(e){"string"==typeof e&&(e={problem:e}),e||(e={}),d?d.close(e):y(e)},d.addEventListener("ready",k),d.addEventListener("message",g),d.addEventListener("close",(function e(n,t){ie("dbus close:",t),d.removeEventListener("ready",k),d.removeEventListener("message",g),d.removeEventListener("close",e),d=null,y(t)}));var _=1;function E(e,t,r){var o="DBus method "+t+" "+r+" not available at "+e;return n.reject(new ae(["org.freedesktop.DBus.Error.UnknownMethod",[o]]))}this.call=function(e,t,r,o,i){var s=n.defer(),l=String(_);_++;var c=a({},i,{call:[e,t,r,o||[]],id:l});return m(JSON.stringify(c))?h[l]=s:s.reject(new ae(u)),s.promise},r.signal=function(e,n,t,r,o){if(d&&d.valid){var i=a({},o,{signal:[e,n,t,r||[]]});m(JSON.stringify(i))}},this.subscribe=function(e,n,t){var r,o={match:a({},e),callback:n};return!1!==t&&m(JSON.stringify({"add-match":o.match})),n&&(r=String(_),_++,f[r]=o),{remove:function(){var e;r&&(e=f[r])&&delete f[r],!1!==t&&e&&m(JSON.stringify({"remove-match":e.match}))}}},r.watch=function(e){var t;t=o(e)?a({},e):{path:String(e)};var r=String(_);_++;var i=n.defer();m(JSON.stringify({watch:t,id:r}))?h[r]=i:i.reject(new ae(u));var s=i.promise;return s.remove=function(){r in h&&(i.reject(new ae("cancelled")),delete h[r]),m(JSON.stringify({unwatch:t}))},s},r.publish=function(e,t,r,o){var i=[e,t],s=String(_);_++;var l=h[s]=n.defer();m(JSON.stringify(a({},o,{publish:i,id:s})))?h[s]=l:l.reject(new ae(u));var c=e+"\n"+t;l.promise.then((function(){p[c]=r}));var d=l.promise;return d.remove=function(){s in h&&(l.reject(new ae("cancelled")),delete h[s]),delete p[c],m(JSON.stringify({unpublish:i}))},d},r.proxy=function(n,t,o){n||(n=e),n=String(n),t||(t="/"+n.replace(/\./g,"/"));var i=r.constructors[n];return i||(i=r.constructors["*"]),o||(o={}),v(),new i(r,c,n,String(t),o)},r.proxies=function(n,t,o){return n||(n=e),t||(t="/"),o||(o={}),v(),new ce(r,c,String(n),String(t),o)}}Object.defineProperty(n,"location",{enumerable:!0,get:function(){return ee&&ee.href===ne()||(ee=new te),ee},set:function(e){n.location.go(e)}}),window.addEventListener("hashchange",(function(){ee=null;var e=window.location.hash;0===e.indexOf("#")&&(e=e.substring(1)),n.hint("location",{hash:e}),n.dispatchEvent("locationchanged")})),n.jump=function(e,t){e=Array.isArray(e)?"/"+e.map(encodeURIComponent).join("/").replace("%40","@").replace("%3D","=").replace(/%2B/g,"+"):""+e,void 0===t&&(t=n.transport.host);var r={command:"jump",location:e,host:t};n.transport.inject("\n"+JSON.stringify(r))},function(){var e,t=!1;function r(){var r=document[e];e&&void 0!==r||(r=!1),!1===r&&(r=t),n.hidden!==r&&(n.hidden=r,n.dispatchEvent("visibilitychange"))}void 0!==document.hidden?(e="hidden",document.addEventListener("visibilitychange",r)):void 0!==document.mozHidden?(e="mozHidden",document.addEventListener("mozvisibilitychange",r)):void 0!==document.msHidden?(e="msHidden",document.addEventListener("msvisibilitychange",r)):void 0!==document.webkitHidden&&(e="webkitHidden",document.addEventListener("webkitvisibilitychange",r)),v=function(e){"hidden"in e&&(t=e.hidden,r())},r()}(),n.spawn=function(e,t){var r=n.defer(),o={payload:"stream",spawn:[]};if(e instanceof Array)for(var i=0;i<e.length;i++)o.spawn.push(String(e[i]));else o.spawn.push(String(e));void 0!==t&&a(o,t);var s=o.spawn[0]||"process",c=n.channel(o),u=c.buffer(null);c.addEventListener("close",(function(e,n){var t=u.squash();oe("process closed:",JSON.stringify(n)),t&&oe("process output:",t),void 0!==n.message&&oe("process error:",n.message),n.problem?r.reject(new re(n,s)):n["exit-status"]||n["exit-signal"]?r.reject(new re(n,s),t):void 0!==n.message?r.resolve(t,n.message):r.resolve(t)}));var d=r.promise;return d.stream=function(e){return u.callback=e.bind(d),this},d.input=function(e,n){return null!=e&&(oe("process input:",e),l(e,(function(e){c.send(e)}))),n||c.control({command:"done"}),this},d.close=function(e){return oe("process closing:",e),c.valid&&c.close(e),this},d},n.script=function(e,t,r){!r&&o(t)&&(r=t,t=[]);var i=["/bin/sh","-c",e,"--"];return i.push.apply(i,t),n.spawn(i,r)};var de={internal:null,session:null,system:null};n.dbus=function(e,n){n||(n={bus:"system"});var t=Object.keys(n),r=n.bus,o=!e&&1==t.length&&r in de;if(o&&de[r])return de[r];var i=new ue(e,n);if(o){const e=i.close;i.close=function(){arguments.length>0&&e.apply(i,arguments)},i.addEventListener("close",(function(){de[r]==i&&(de[r]=null)})),de[r]=i}return i},n.variant=function(e,n){return{v:n,t:e}},n.byte_array=function(e){return window.btoa(e)},n.file=function(e,t){var r=(t=t||{}).binary,o={path:e,read:d,replace:p,modify:function(e,t,r){var o=n.defer();function i(n,t){var r=e(n);void 0===r&&(r=n),p(r,t).done((function(e){o.resolve(r,e)})).fail((function(e){"change-conflict"==e.problem?a():o.reject(e)}))}function a(){d().done(i).fail((function(e){o.reject(e)}))}void 0===t?a():i(t,r);return o.promise},watch:function(e,n){e&&v.push(e);return m+=1,w(n),h=null,d(),{remove:function(){var t;e&&(t=v.indexOf(e))>-1&&(v[t]=null),m-=1,w(n)}}},close:function(){c&&c.close("cancelled");f&&f.close("cancelled");g&&g.close("cancelled")}},i=a({},t);delete i.syntax;var c,u=null;function d(){if(u)return u;var o=n.defer(),s=a({},i,{payload:"fsread1",path:e});return function e(){c=n.channel(s);var i=[];c.addEventListener("message",(function(e,n){i.push(n)})),c.addEventListener("close",(function(n,a){if(c=null,"change-conflict"!=a.problem){if(u=null,a.problem){var s=new Q(a.problem,a.message);return b(null,null,s),void o.reject(s)}var l,d;if("-"==a.tag)l=null;else try{d=O(i,r),l=t.syntax&&t.syntax.parse?t.syntax.parse(d):d}catch(e){return b(null,null,e),void o.reject(e)}b(l,a.tag),o.resolve(l,a.tag)}else e()}))}(),u=o.promise}var f=null;function p(r,o){var s,c,u=n.defer();try{null===r?s=null:(c=r,s=t.syntax&&t.syntax.stringify?t.syntax.stringify(c):c)}catch(e){return u.reject(e),u.promise}f&&f.close("abort");var d=a({},i,{payload:"fsreplace1",path:e,tag:o});return(f=n.channel(d)).addEventListener("close",(function(e,n){f=null,n.problem?u.reject(new Q(n.problem,n.message)):(b(r,n.tag),u.resolve(n.tag))})),l(s,(function(e){f.send(e)})),f.control({command:"done"}),u.promise}var h,v=[],m=0,g=null;function w(t){if(m>0){if(g)return;const r={payload:"fswatch1",path:e,superuser:i.superuser};(g=n.channel(r)).addEventListener("message",(function(n,r){var o;try{o=JSON.parse(r)}catch(e){o=null}o&&o.path==e&&o.tag&&o.tag!=h&&(t&&void 0!==t.read&&!t.read?b(null,o.tag):d())}))}else g&&(g.close(),g=null)}function b(){h=arguments[1]||null,s(v,o,arguments)}return o};var fe,pe={};function he(e){return!0===e?1:e||0}n.language="en",n.locale=function(e){var t,r=n.language;e?(a(pe,e),t=e[""]):null===e&&(pe={}),t&&(t["plural-forms"]&&(fe=t["plural-forms"]),t.language&&(r=t.language)),n.language=r},n.translate=function(){var e,t,r,o,i,a,s,l,c,u,d;for(t=0,r=(e=0===arguments.length?[document]:1===arguments.length&&arguments[0].length?arguments[0]:arguments).length;t<r;t++)if(c=null,e[t].querySelectorAll&&(c=e[t].querySelectorAll("[translatable], [translate]")),c)for(i=0,a=c.length;i<a;i++)if("no"!=(o=(d=c[i]).getAttribute("translate")||d.getAttribute("translatable")||"yes")){for(u=o.split(" "),o=d.getAttribute("translate-context")||d.getAttribute("context"),s=0,l=u.length;s<l;s++)"yes"==u[s]||"translate"==u[s]?d.textContent=n.gettext(o,d.textContent):u[s]&&d.setAttribute(u[s],n.gettext(o,d.getAttribute(u[s])||""));d.removeAttribute("translatable"),d.removeAttribute("translate")}},n.gettext=function(e,n){1==arguments.length&&(n=e,e=void 0);var t=e?e+""+n:n;if(pe){var r=pe[t];if(r&&r[1])return r[1]}return n},n.ngettext=function(e,n,t,r){3==arguments.length&&(r=t,t=n,n=e,e=void 0);var o=e?e+""+n:n;if(pe&&fe){var i=pe[o];if(i){var a=he(fe(r))+1;if(i[a])return i[a]}}return 1==r?n:t},n.noop=function(e,n){return arguments[arguments.length-1]};var ve=n.gettext;function me(e,n,t){this.status=parseInt(e,10),this.reason=n,this.message=t||n,this.problem=null,this.valueOf=function(){return this.status},this.toString=function(){return this.status+" "+this.message}}function ge(){"all"!=window.debugging&&"http"!=window.debugging||console.debug.apply(console,arguments)}function we(e,n){if(e)for(var t in n=n.toLowerCase(),e)if(t.toLowerCase()==n)return e[t]}function be(e,t){var r=this;r.options=t,t.payload="http-stream2";var i=[];if(void 0!==e)if(e.indexOf&&0===e.indexOf("/"))t.unix=e;else{var c=parseInt(e,10);if(isNaN(c))throw Error("The endpoint must be either a unix path or port number");t.port=c}function u(e){return Object.keys(e).map((function(n){return encodeURIComponent(n)+"="+encodeURIComponent(e[n])})).join("&").split("%20").join("+")}t.address&&(t.capabilities||(t.capabilities=[]),t.capabilities.push("address")),r.request=function(e){var r=n.defer(),o=r.promise;e.path||(e.path="/"),e.method||(e.method="GET"),e.params&&(-1===e.path.indexOf("?")?e.path+="?"+u(e.params):e.path+="&"+u(e.params)),delete e.params;var c=e.body;delete e.body;var d=e.headers;delete e.headers,a(e,t),t.headers&&d?e.headers=a({},t.headers,d):t.headers?e.headers=t.headers:e.headers=d,ge("http request:",JSON.stringify(e));var f=n.channel(e);void 0!==c&&(""!==c&&(ge("http input:",c),l(c,(function(e){f.send(e)}))),ge("http done"),f.control({command:"done"}));var p=null,h=null,v=null,m=f.buffer((function(e){return v&&v.status>=200&&v.status<=299&&p?p.call(o,e):0}));function g(e,n){"response"==n.command&&(v=n,h&&(v.headers=v.headers||{},s(h,o,[v.status,v.headers])))}return f.addEventListener("control",g),f.addEventListener("close",(function e(n,t){var a=i.indexOf(o);if(a>=0&&i.splice(a,1),t.problem)ge("http problem: ",t.problem),r.reject(new Q(t.problem));else{var s=m.squash();if(v&&(v.status<200||v.status>299)){var l,c=we(v.headers,"Content-Type");c&&!f.binary&&0===c.indexOf("text/plain")&&(l=s),ge("http status: ",v.status),r.reject(new me(v.status,v.reason,l),s)}else ge("http done"),r.resolve(s)}f.removeEventListener("control",g),f.removeEventListener("close",e)})),o.stream=function(e){return p=e,o},o.response=function(e){return null===h&&(h=[]),h.push(e),o},o.input=function(e,n){return null!=e&&(ge("http input:",e),l(e,(function(e){f.send(e)}))),n||(ge("http done"),f.control({command:"done"})),o},o.close=function(e){return ge("http closing:",e),f.close(e),o},i.push(o),o},r.get=function(e,n,t){return r.request({method:"GET",params:n,path:e,body:"",headers:t})},r.post=function(e,n,t){return t=t||{},o(n)||Array.isArray(n)?(n=JSON.stringify(n),void 0===we(t,"Content-Type")&&(t["Content-Type"]="application/json")):null==n?n="":"string"!=typeof n&&(n=String(n)),r.request({method:"POST",path:e,body:n,headers:t})},r.close=function(e){for(var n=i.slice(),t=0;t<n.length;t++)n[t].close(e)}}function ye(e){var t=this;S(t,{});var r=n.dbus(null,{bus:"internal"}).proxy("cockpit.Superuser","/superuser");function o(){r.valid&&null!==t.allowed&&t.allowed!=("none"!=r.Current)&&window.location.reload(!0)}r.addEventListener("changed",o),t.allowed=null,t.user=e?e.user:null,t.is_superuser=e?e._is_superuser:null;var i=null,a=!1;function s(e){return 0===e.id||(i?!!(e.groups||[]).includes(i):a?t.is_superuser:void 0===e.id&&null)}e&&(i=e.group),e&&e.admin&&(a=!0),t.user&&null!==t.is_superuser?t.allowed=s(t.user):Promise.all([n.user(),new Promise(((e,t)=>{const r=n.channel({payload:"null",superuser:"require"});r.wait().then((()=>e(!0))).catch((()=>e(!1))).always((()=>r.close()))}))]).then((([e,n])=>{t.user=e,t.is_superuser=n;const r=s(e);t.allowed!==r&&(t.allowed=r,o(),t.dispatchEvent("changed"))})),t.close=function(){}}function ke(e,t,r){var o=this;S(o,{}),void 0===t.length&&(t=[t]);var i=[],s=!1;function l(t,r,c){if(0!==t.length){if(!c){if(s)return;s=!0}var u=a({payload:"metrics1",interval:e,source:"internal"},t[0]);delete u.archive_source;var d=n.channel(u);i.push(d);var f,p=null,h=null;d.addEventListener("close",(function(e,n){c||(s=!1),t.length>1&&("not-supported"==n.problem||"not-found"==n.problem)?l(t.slice(1),r):n.problem?"terminated"==n.problem||"disconnected"==n.problem||"authentication-failed"==n.problem||"not-found"==n.problem&&c||"not-supported"==n.problem&&c||console.warn("metrics channel failed: "+n.problem):c&&(o.archives||(o.archives=!0,o.dispatchEvent("changed")))})),d.addEventListener("message",(function(n,i){var a,s,l,c,u,d,v,m,g,w,b=JSON.parse(i),y=b.length;if(void 0===y)w=0,(p=b).now&&p.timestamp&&(w=p.timestamp+(Date.now()-p.now)),f=Math.floor(w/e),r(f,p,null,t[0]),o.meta=p,o.dispatchEvent("changed");else if(p){for(v=0;v<y;v++){if(a=b[v],h)for(s=h.length,m=0;m<s;m++)if(null==(l=a[m]))a[m]=h[m];else if(void 0!==(c=l.length)){for(u=h[m],d=h[m].length,g=0;g<c;g++)null===l[g]&&(l[g]=u[g]);for(;g<d;g++)l[g]=u[g]}h=a}r(f,p,b,t[0]),f+=y,p.timestamp+=e*y}}))}}function c(e,n,t,r){var i,a,s;(i=n.mapping)||(i={},n.metrics.forEach((function(e,n){a={"":n},s=r.metrics_path_names?r.metrics_path_names[n]:e.name,i[s]=a,e.instances&&e.instances.forEach((function(e,n){""===e&&(e="/"),a[e]={"":n}}))})),n.mapping=i),t&&o.series.input(e,t,i)}o.series=n.series(e,r,(function(e,n,t){t?o.follow():o.fetch(e,n)})),o.archives=null,o.meta=null,o.fetch=function(n,r){for(var o=n*e-Date.now(),i=r-n,s=[],u=0;u<t.length;u++)t[u].archive_source&&s.push(a({},t[u],{source:t[u].archive_source,timestamp:o,limit:i}));l(s,c,!0)},o.follow=function(){l(t,c)},o.close=function(e){var n,t=i.length;for(o.series&&o.series.close(),n=0;n<t;n++)i[n].close(e)}}n.message=function(e){if(e.message)return e.message;var n=null;return"terminated"==(n=e.problem?e.problem:e+"")?ve("Your session has been terminated."):"no-session"==n?ve("Your session has expired. Please log in again."):"access-denied"==n?ve("Not permitted to perform this action."):"authentication-failed"==n?ve("Login failed"):"authentication-not-supported"==n?ve("The server refused to authenticate using any supported methods."):"unknown-hostkey"==n||"unknown-host"==n?ve("Untrusted host"):"invalid-hostkey"==n?ve("Host key is incorrect"):"internal-error"==n?ve("Internal error"):"timeout"==n?ve("Connection has timed out."):"no-cockpit"==n?ve("Cockpit is not installed on the system."):"no-forwarding"==n?ve("Cannot forward login credentials"):"disconnected"==n?ve("Server has closed the connection."):"not-supported"==n?ve("Cockpit is not compatible with the software on the system."):"no-host"==n?ve("Cockpit could not contact the given host."):"too-large"==n?ve("Too much data"):n},n.http=function(e,n){return o(e)&&void 0===n&&(n=e,e=void 0),new be(e,n||{})},n.permission=function(e){return new ye(e)},n.metrics=function(e,n){return new ke(e,n)},n.oops=function(){window.parent!==window&&0===window.name.indexOf("cockpit1:")&&window.parent.postMessage('\n{ "command": "oops" }',w)};var _e=window.onerror;return window.onerror=function(e,t,r){return n.oops(),!!_e&&_e(e,t,r)},n}()}()})();